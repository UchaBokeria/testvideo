/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(ld){o(ld)}}function a(t){try{u(r.throw(t))}catch(ld){o(ld)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function i(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(ld){o=[6,ld],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function o(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function a(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};function c(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=c(t[n],e[n]));return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var h=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function f(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(ld){return!1}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var p=function(t){function n(e,r,i){var o=t.call(this,r)||this;return o.code=e,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,d.prototype.create),o}return e(n,t),n}(Error),d=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?y(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new p(i,a,r);return u},t}();function y(t,e){return t.replace(v,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var v=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function m(t,e){var n=new b(t,e);return n.subscribe.bind(n)}var b=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=w),void 0===r.error&&(r.error=w),void 0===r.complete&&(r.complete=w);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(ld){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(ld){"undefined"!=typeof console&&console.error&&console.error(ld)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function w(){}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E(t){return t&&t._delegate?t._delegate:t}var I=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),T=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new h;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(ld){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(ld){if(r)return null;throw ld}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t))try{this.getOrInitializeService({instanceIdentifier:"[DEFAULT]"})}catch(ld){}try{for(var r=o(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var a=s(i.value,2),u=a[0],c=a[1],h=this.normalizeInstanceIdentifier(u);try{var l=this.getOrInitializeService({instanceIdentifier:h});c.resolve(l)}catch(ld){}}}catch(f){e={error:f}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t="[DEFAULT]"),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(a(a([],s(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),s(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t="[DEFAULT]"),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,a=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(a))throw Error(this.name+"("+a+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var u=this.getOrInitializeService({instanceIdentifier:a,options:i});try{for(var c=o(this.instancesDeferred.entries()),h=c.next();!h.done;h=c.next()){var l=s(h.value,2),f=l[0],p=l[1];a===this.normalizeInstanceIdentifier(f)&&p.resolve(u)}}catch(d){e={error:d}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return this.invokeOnInitCallbacks(u,a),u},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.has(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var s=o(i),a=s.next();!a.done;a=s.next()){var u=a.value;try{u(t,e)}catch(c){}}}catch(h){n={error:h}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,"[DEFAULT]"===e?void 0:e),options:i}),this.instances.set(n,o),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(s){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t="[DEFAULT]"),this.component?this.component.multipleInstances?t:"[DEFAULT]":t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _,S=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new T(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function A(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var N,D,C=[];(D=N||(N={}))[D.DEBUG=0]="DEBUG",D[D.VERBOSE=1]="VERBOSE",D[D.INFO=2]="INFO",D[D.WARN=3]="WARN",D[D.ERROR=4]="ERROR",D[D.SILENT=5]="SILENT";var k,R={debug:N.DEBUG,verbose:N.VERBOSE,info:N.INFO,warn:N.WARN,error:N.ERROR,silent:N.SILENT},x=N.INFO,O=((_={})[N.DEBUG]="log",_[N.VERBOSE]="log",_[N.INFO]="info",_[N.WARN]="warn",_[N.ERROR]="error",_),L=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=O[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,A(["["+i+"]  "+t.name+":"],n))}},P=function(){function t(t){this.name=t,this._logLevel=x,this._logHandler=L,this._userLogHandler=null,C.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in N))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?R[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,N.DEBUG],t)),this._logHandler.apply(this,A([this,N.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,N.VERBOSE],t)),this._logHandler.apply(this,A([this,N.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,N.INFO],t)),this._logHandler.apply(this,A([this,N.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,N.WARN],t)),this._logHandler.apply(this,A([this,N.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,A([this,N.ERROR],t)),this._logHandler.apply(this,A([this,N.ERROR],t))},t}();function F(t){C.forEach((function(e){e.setLogLevel(t)}))}var M,V=((k={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",k["bad-app-name"]="Illegal App name: '{$appName}",k["duplicate-app"]="Firebase App named '{$appName}' already exists",k["app-deleted"]="Firebase App named '{$appName}' already deleted",k["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",k["invalid-log-argument"]="First argument to `onLog` must be null or a function.",k),U=new d("app","Firebase",V),q=((M={})["@firebase/app"]="fire-core",M["@firebase/analytics"]="fire-analytics",M["@firebase/app-check"]="fire-app-check",M["@firebase/auth"]="fire-auth",M["@firebase/database"]="fire-rtdb",M["@firebase/functions"]="fire-fn",M["@firebase/installations"]="fire-iid",M["@firebase/messaging"]="fire-fcm",M["@firebase/performance"]="fire-perf",M["@firebase/remote-config"]="fire-rc",M["@firebase/storage"]="fire-gcs",M["@firebase/firestore"]="fire-fst",M["fire-js"]="fire-js",M["firebase-wrapper"]="fire-js-all",M),B=new P("@firebase/app"),j=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=c(void 0,t),this.container=new S(e.name),this._addComponent(new I("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e="[DEFAULT]"),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(ld){B.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,ld)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw U.create("app-deleted",{appName:this.name_})},t}();j.prototype.name&&j.prototype.options||j.prototype.delete||console.log("dc");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function K(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name="[DEFAULT]");var s=o.name;if("string"!=typeof s||!s)throw U.create("bad-app-name",{appName:String(s)});if(g(e,s))throw U.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=q[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void B.warn(u.join(" "))}o(new I(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:F,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw U.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=R[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:N[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=C;r<i.length;r++)n(i[r])}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t,e)},apps:null,SDK_VERSION:"8.6.7",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!g(e,t=t||"[DEFAULT]"))throw U.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return B.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw U.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&c(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,h=Object.keys(e);u<h.length;u++){var l=h[u];e[l]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var G=function t(){var e=K(j);return e.INTERNAL=n(n({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){c(e,t)},createSubscribe:m,ErrorFactory:d,deepExtend:c}),e}(),z=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){B.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var H=self.firebase.SDK_VERSION;H&&H.indexOf("LITE")>=0&&B.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Q=G.initializeApp;G.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return f()&&B.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Q.apply(void 0,t)};var W,Y,X=G;(W=X).INTERNAL.registerComponent(new I("platform-logger",(function(t){return new z(t)}),"PRIVATE")),W.registerVersion("@firebase/app","0.6.26",Y),W.registerVersion("fire-js","");
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
X.registerVersion("firebase","8.6.7","app"),X.SDK_VERSION="8.6.7";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var $=function(t,e){return($=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function J(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Z,tt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},et=et||{},nt=tt||self;function rt(){}function it(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function ot(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var st="closure_uid_"+(1e9*Math.random()>>>0),at=0;function ut(t,e,n){return t.call.apply(t.bind,arguments)}function ct(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function ht(t,e,n){return(ht=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ut:ct).apply(null,arguments)}function lt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function ft(){return Date.now()}function pt(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Pb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function dt(){this.j=this.j,this.i=this.i}dt.prototype.j=!1,dt.prototype.ka=function(){var t;!this.j&&(this.j=!0,this.H(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,st)&&t[st]||(t[st]=++at))},dt.prototype.H=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var yt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},vt=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function gt(t){return Array.prototype.concat.apply([],arguments)}function mt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function bt(t){return/^[\s\xa0]*$/.test(t)}var wt,Et=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function It(t,e){return-1!=t.indexOf(e)}function Tt(t,e){return t<e?-1:t>e?1:0}t:{var _t=nt.navigator;if(_t){var St=_t.userAgent;if(St){wt=St;break t}}wt=""}function At(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Nt(t){var e={};for(var n in t)e[n]=t[n];return e}var Dt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ct(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Dt.length;o++)n=Dt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function kt(t){return kt[" "](t),t}kt[" "]=rt;var Rt,xt,Ot=It(wt,"Opera"),Lt=It(wt,"Trident")||It(wt,"MSIE"),Pt=It(wt,"Edge"),Ft=Pt||Lt,Mt=It(wt,"Gecko")&&!(It(wt.toLowerCase(),"webkit")&&!It(wt,"Edge"))&&!(It(wt,"Trident")||It(wt,"MSIE"))&&!It(wt,"Edge"),Vt=It(wt.toLowerCase(),"webkit")&&!It(wt,"Edge");function Ut(){var t=nt.document;return t?t.documentMode:void 0}t:{var qt="",Bt=(xt=wt,Mt?/rv:([^\);]+)(\)|;)/.exec(xt):Pt?/Edge\/([\d\.]+)/.exec(xt):Lt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(xt):Vt?/WebKit\/(\S+)/.exec(xt):Ot?/(?:Version)[ \/]?(\S+)/.exec(xt):void 0);if(Bt&&(qt=Bt?Bt[1]:""),Lt){var jt=Ut();if(null!=jt&&jt>parseFloat(qt)){Rt=String(jt);break t}}Rt=qt}var Kt,Gt={};function zt(t){return function(t,e){var n=Gt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=Et(String(Rt)).split("."),r=Et(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=Tt(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||Tt(0==s[2].length,0==a[2].length)||Tt(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}if(nt.document&&Lt){var Ht=Ut();Kt=Ht||(parseInt(Rt,10)||void 0)}else Kt=void 0;var Qt=Kt,Wt=!Lt||9<=Number(Qt),Yt=Lt&&!zt("9"),Xt=function(){if(!nt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{nt.addEventListener("test",rt,e),nt.removeEventListener("test",rt,e)}catch(n){}return t}();function $t(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Jt(t,e){if($t.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Mt){t:{try{kt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Zt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}$t.prototype.b=function(){this.defaultPrevented=!0},pt(Jt,$t);var Zt={2:"touch",3:"pen",4:"mouse"};Jt.prototype.b=function(){Jt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Yt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var te="closure_listenable_"+(1e6*Math.random()|0),ee=0;function ne(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++ee,this.Y=this.Z=!1}function re(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function ie(t){this.src=t,this.a={},this.b=0}function oe(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=yt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(re(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function se(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}ie.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=se(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new ne(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var ae="closure_lm_"+(1e6*Math.random()|0),ue={};function ce(t,e,n,r,i){if(r&&r.once)return le(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)ce(t,e[o],n,r,i);return null}return n=be(n),t&&t[te]?t.wa(e,n,ot(r)?!!r.capture:!!r,i):he(t,e,n,!1,r,i)}function he(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=ot(i)?!!i.capture:!!i;if(s&&!Wt)return null;var a=ge(t);if(a||(t[ae]=a=new ie(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=ve,e=Wt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Xt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(de(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function le(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)le(t,e[o],n,r,i);return null}return n=be(n),t&&t[te]?t.xa(e,n,ot(r)?!!r.capture:!!r,i):he(t,e,n,!0,r,i)}function fe(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)fe(t,e[o],n,r,i);else r=ot(r)?!!r.capture:!!r,n=be(n),t&&t[te]?(t=t.c,(e=String(e).toString())in t.a&&(-1<(n=se(o=t.a[e],n,r,i))&&(re(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=ge(t))&&(e=t.a[e.toString()],t=-1,e&&(t=se(e,n,r,i)),(n=-1<t?e[t]:null)&&pe(n))}function pe(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[te])oe(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(de(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ge(e))?(oe(n,t),0==n.b&&(n.src=null,e[ae]=null)):re(t)}}}function de(t){return t in ue?ue[t]:ue[t]="on"+t}function ye(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&pe(t),n.call(r,e)}function ve(t,e){if(t.Y)return!0;if(!Wt){if(!e)t:{e=["window","event"];for(var n=nt,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return ye(t,e=new Jt(e,this))}return ye(t,new Jt(e,this))}function ge(t){return(t=t[ae])instanceof ie?t:null}var me="__closure_events_fn_"+(1e9*Math.random()>>>0);function be(t){return"function"==typeof t?t:(t[me]||(t[me]=function(e){return t.handleEvent(e)}),t[me])}function we(){dt.call(this),this.c=new ie(this),this.J=this,this.D=null}function Ee(t,e){var n,r=t.D;if(r)for(n=[];r;r=r.D)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new $t(e,t);else if(e instanceof $t)e.target=e.target||t;else{var i=e;Ct(e=new $t(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Ie(s,r,!0,e)&&i}if(i=Ie(s=e.a=t,r,!0,e)&&i,i=Ie(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Ie(s=e.a=n[o],r,!1,e)&&i}function Ie(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.da||s.src;s.Z&&oe(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}pt(we,dt),we.prototype[te]=!0,(Z=we.prototype).addEventListener=function(t,e,n,r){ce(this,t,e,n,r)},Z.removeEventListener=function(t,e,n,r){fe(this,t,e,n,r)},Z.H=function(){if(we.X.H.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)re(n[r]);delete e.a[t],e.b--}}this.D=null},Z.wa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},Z.xa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Te=nt.JSON.stringify;function _e(){this.b=this.a=null}var Se,Ae=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new De}),(function(t){t.reset()}));function Ne(){var t=xe,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function De(){this.next=this.b=this.a=null}function Ce(t){nt.setTimeout((function(){throw t}),0)}function ke(t,e){Se||function(){var t=nt.Promise.resolve(void 0);Se=function(){t.then(Oe)}}(),Re||(Se(),Re=!0),xe.add(t,e)}_e.prototype.add=function(t,e){var n=Ae.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},De.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},De.prototype.reset=function(){this.next=this.b=this.a=null};var Re=!1,xe=new _e;function Oe(){for(var t;t=Ne();){try{t.a.call(t.b)}catch(n){Ce(n)}var e=Ae;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Re=!1}function Le(t,e){we.call(this),this.b=t||1,this.a=e||nt,this.f=ht(this.eb,this),this.g=ft()}function Pe(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Fe(t,e,n){if("function"==typeof t)n&&(t=ht(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=ht(t.handleEvent,t)}return 2147483647<Number(e)?-1:nt.setTimeout(t,e||0)}function Me(t){t.a=Fe((function(){t.a=null,t.c&&(t.c=!1,Me(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}pt(Le,we),(Z=Le.prototype).aa=!1,Z.M=null,Z.eb=function(){if(this.aa){var t=ft()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ee(this,"tick"),this.aa&&(Pe(this),this.start()))}},Z.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=ft())},Z.H=function(){Le.X.H.call(this),Pe(this),delete this.a};var Ve=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}$(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Me(this)},e.prototype.H=function(){t.prototype.H.call(this),this.a&&(nt.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(dt);function Ue(t){dt.call(this),this.b=t,this.a={}}pt(Ue,dt);var qe=[];function Be(t,e,n,r){Array.isArray(n)||(n&&(qe[0]=n.toString()),n=qe);for(var i=0;i<n.length;i++){var o=ce(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function je(t){At(t.a,(function(t,e){this.a.hasOwnProperty(e)&&pe(t)}),t),t.a={}}function Ke(){this.a=!0}function Ge(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Te(n)}catch(a){return e}}(t,n)+(r?" "+r:"")}))}Ue.prototype.H=function(){Ue.X.H.call(this),je(this)},Ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ke.prototype.info=function(){};var ze={},He=null;function Qe(){return He=He||new we}function We(t){$t.call(this,ze.Ga,t)}function Ye(t){var e=Qe();Ee(e,new We(e,t))}function Xe(t,e){$t.call(this,ze.STAT_EVENT,t),this.stat=e}function $e(t){var e=Qe();Ee(e,new Xe(e,t))}function Je(t){$t.call(this,ze.Ha,t)}function Ze(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return nt.setTimeout((function(){t()}),e)}ze.Ga="serverreachability",pt(We,$t),ze.STAT_EVENT="statevent",pt(Xe,$t),ze.Ha="timingevent",pt(Je,$t);var tn={NO_ERROR:0,fb:1,sb:2,rb:3,mb:4,qb:5,tb:6,Ea:7,TIMEOUT:8,wb:9},en={kb:"complete",Gb:"success",Fa:"error",Ea:"abort",yb:"ready",zb:"readystatechange",TIMEOUT:"timeout",ub:"incrementaldata",xb:"progress",nb:"downloadprogress",Ob:"uploadprogress"};function nn(){}function rn(t){return t.b||(t.b=t.c())}function on(){}nn.prototype.b=null;var sn,an={OPEN:"a",jb:"b",Fa:"c",vb:"d"};function un(){$t.call(this,"d")}function cn(){$t.call(this,"c")}function hn(){}function ln(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Ue(this),this.P=fn,t=Ft?125:void 0,this.R=new Le(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.G=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}pt(un,$t),pt(cn,$t),pt(hn,nn),hn.prototype.a=function(){return new XMLHttpRequest},hn.prototype.c=function(){return{}},sn=new hn;var fn=45e3,pn={},dn={};function yn(t,e,n){t.G=1,t.i=Mn(Rn(e)),t.j=n,t.I=!0,vn(t,null)}function vn(t,e){t.u=ft(),bn(t),t.l=Rn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Xn(n.b,"t",r),t.D=0,t.a=Gr(t.g,t.g.C?e:null),0<t.O&&(t.F=new Ve(ht(t.Da,t,t.a),t.O)),Be(t.J,t.a,"readystatechange",t.bb),e=t.B?Nt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Ye(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function gn(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=mn(t,n);if(i==dn){4==e&&(t.h=4,$e(14),r=!1),Ge(t.c,t.f,null,"[Incomplete Response]");break}if(i==pn){t.h=4,$e(15),Ge(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Ge(t.c,t.f,i,null),_n(t,i)}4==e&&0==n.length&&(t.h=1,$e(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Fr(e),e.F=!0,$e(11))):(Ge(t.c,t.f,n,"[Invalid Chunked Response]"),Tn(t),In(t))}function mn(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?dn:(n=Number(e.substring(n,r)),isNaN(n)?pn:(r+=1)+n>e.length?dn:(e=e.substr(r,n),t.D=r+n,e))}function bn(t){t.T=ft()+t.P,wn(t,t.P)}function wn(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ze(ht(t.$a,t),e)}function En(t){t.o&&(nt.clearTimeout(t.o),t.o=null)}function In(t){0==t.g.v||t.A||Ur(t.g,t)}function Tn(t){En(t);var e=t.F;e&&"function"==typeof e.ka&&e.ka(),t.F=null,Pe(t.R),je(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ka())}function _n(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||rr(n.b,t)))if(n.I=t.N,!t.C&&rr(n.b,t)&&3==n.v){try{var r=n.la.a.parse(e)}catch(v){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Vr(n),Nr(n)}Pr(n),$e(18)}}else n.pa=i[1],0<n.pa-n.P&&37500>i[2]&&n.G&&0==n.o&&!n.m&&(n.m=Ze(ht(n.Xa,n),6e3));if(1>=nr(n.b)&&n.fa){try{n.fa()}catch(v){}n.fa=void 0}}else Br(n,11)}else if((t.C||n.a==t)&&Vr(n),!bt(e))for(e=r=n.la.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ha=i[2];var o=i[3];null!=o&&(n.ia=o,n.c.info("VER="+n.ia));var s=i[4];null!=s&&(n.qa=s,n.c.info("SVER="+n.qa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=u.b;!l.a&&(It(h,"spdy")||It(h,"quic")||It(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(ir(l,l.b),l.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.oa=f,Fn(u.B,u.A,f))}}n.v=3,n.f&&n.f.ua(),n.U&&(n.N=ft()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((u=n).ma=Kr(u,u.C?u.ha:null,u.ga),p.C){or(u.b,p);var d=p,y=u.D;y&&d.setTimeout(y),d.o&&(En(d),bn(d)),u.a=p}else Lr(u);0<n.g.length&&kr(n)}else"stop"!=i[0]&&"close"!=i[0]||Br(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Br(n,7):Ar(n):"noop"!=i[0]&&n.f&&n.f.ta(i),n.o=0);Ye(4)}catch(v){}}function Sn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(it(t)||"string"==typeof t)vt(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(it(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(it(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function An(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof An)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Nn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Dn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Dn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Dn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Z=ln.prototype).setTimeout=function(t){this.P=t},Z.bb=function(t){t=t.target;var e=this.F;e&&3==Ir(t)?e.f():this.Da(t)},Z.Da=function(t){try{if(t==this.a)t:{var e=Ir(this.a),n=this.a.va(),r=this.a.W();if(!(3>e||3==e&&!Ft&&!this.a.$())){this.A||4!=e||7==n||Ye(8==n||0>=r?3:2),En(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!bt(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,$e(12),Tn(this),In(this);break t}Ge(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,_n(this,u)}this.I?(gn(this,e,o),Ft&&this.b&&3==e&&(Be(this.J,this.R,"tick",this.ab),this.R.start())):(Ge(this.c,this.f,o,null),_n(this,o)),4==e&&Tn(this),this.b&&!this.A&&(4==e?Ur(this.g,this):(this.b=!1,bn(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,$e(12)):(this.h=0,$e(13)),Tn(this),In(this)}}}catch(c){}},Z.ab=function(){if(this.a){var t=Ir(this.a),e=this.a.$();this.D<e.length&&(En(this),gn(this,t,e),this.b&&4!=t&&bn(this))}},Z.cancel=function(){this.A=!0,Tn(this)},Z.$a=function(){this.o=null;var t=ft();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.G&&(Ye(3),$e(17)),Tn(this),this.h=2,In(this)):wn(this,this.T-t)},(Z=An.prototype).K=function(){Nn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},Z.L=function(){return Nn(this),this.a.concat()},Z.get=function(t,e){return Dn(this.b,t)?this.b[t]:e},Z.set=function(t,e){Dn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},Z.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Cn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function kn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof kn){this.a=void 0!==e?e:t.a,xn(this,t.f),this.j=t.j,On(this,t.c),Ln(this,t.h),this.g=t.g,e=t.b;var n=new Hn;n.c=e.c,e.a&&(n.a=new An(e.a),n.b=e.b),Pn(this,n),this.i=t.i}else t&&(n=String(t).match(Cn))?(this.a=!!e,xn(this,n[1]||"",!0),this.j=Vn(n[2]||""),On(this,n[3]||"",!0),Ln(this,n[4]),this.g=Vn(n[5]||"",!0),Pn(this,n[6]||"",!0),this.i=Vn(n[7]||"")):(this.a=!!e,this.b=new Hn(null,this.a))}function Rn(t){return new kn(t)}function xn(t,e,n){t.f=n?Vn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function On(t,e,n){t.c=n?Vn(e,!0):e}function Ln(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Pn(t,e,n){e instanceof Hn?(t.b=e,function(t,e){e&&!t.f&&(Qn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Wn(this,e),Xn(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Un(e,Gn)),t.b=new Hn(e,t.a))}function Fn(t,e,n){t.b.set(e,n)}function Mn(t){return Fn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^ft()).toString(36)),t}function Vn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,qn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function qn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}kn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Un(e,Bn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Un(e,Bn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Un(n,"/"==n.charAt(0)?Kn:jn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Un(n,zn)),t.join("")};var Bn=/[#\/\?@]/g,jn=/[#\?:]/g,Kn=/[#\?]/g,Gn=/[#\?@]/g,zn=/#/g;function Hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Qn(t){t.a||(t.a=new An,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Wn(t,e){Qn(t),e=$n(t,e),Dn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Dn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Nn(t)))}function Yn(t,e){return Qn(t),e=$n(t,e),Dn(t.a.b,e)}function Xn(t,e,n){Wn(t,e),0<n.length&&(t.c=null,t.a.set($n(t,e),mt(n)),t.b+=n.length)}function $n(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(Z=Hn.prototype).add=function(t,e){Qn(this),this.c=null,t=$n(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},Z.forEach=function(t,e){Qn(this),this.a.forEach((function(n,r){vt(n,(function(n){t.call(e,n,r,this)}),this)}),this)},Z.L=function(){Qn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Z.K=function(t){Qn(this);var e=[];if("string"==typeof t)Yn(this,t)&&(e=gt(e,this.a.get($n(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=gt(e,t[n])}return e},Z.set=function(t,e){return Qn(this),this.c=null,Yn(this,t=$n(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},Z.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},Z.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Jn=function(t,e){this.b=t,this.a=e};function Zn(t){this.g=t||tr,nt.PerformanceNavigationTiming?t=0<(t=nt.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(nt.ja&&nt.ja.za&&nt.ja.za()&&nt.ja.za().Qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var tr=10;function er(t){return!!t.b||!!t.a&&t.a.size>=t.f}function nr(t){return t.b?1:t.a?t.a.size:0}function rr(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function ir(t,e){t.a?t.a.add(e):t.b=e}function or(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function sr(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=J(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(a){e={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return mt(t.c)}function ar(){}function ur(){this.a=new ar}function cr(t,e,n){var r=n||"";try{Sn(t,(function(t,n){var i=t;ot(t)&&(i=Te(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(ld){throw e.push(r+"type="+encodeURIComponent("_badmap")),ld}}function hr(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Zn.prototype.cancel=function(){var t,e;if(this.c=sr(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=J(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},ar.prototype.stringify=function(t){return nt.JSON.stringify(t,void 0)},ar.prototype.parse=function(t){return nt.JSON.parse(t,void 0)};var lr=nt.JSON.parse;function fr(t){we.call(this),this.headers=new An,this.l=t||null,this.b=!1,this.u=this.a=null,this.C="",this.h=0,this.f="",this.g=this.B=this.m=this.A=!1,this.s=0,this.o=null,this.I=pr,this.F=this.G=!1}pt(fr,we);var pr="",dr=/^https?$/i,yr=["POST","PUT"];function vr(t){return"content-type"==t.toLowerCase()}function gr(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,mr(t),wr(t)}function mr(t){t.A||(t.A=!0,Ee(t,"complete"),Ee(t,"error"))}function br(t){if(t.b&&void 0!==et&&(!t.u[1]||4!=Ir(t)||2!=t.W()))if(t.m&&4==Ir(t))Fe(t.Aa,0,t);else if(Ee(t,"readystatechange"),4==Ir(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.C).match(Cn)[1]||null;if(!o&&nt.self&&nt.self.location){var s=nt.self.location.protocol;o=s.substr(0,s.length-1)}i=!dr.test(o?o.toLowerCase():"")}e=i}if(e)Ee(t,"complete"),Ee(t,"success");else{t.h=6;try{var a=2<Ir(t)?t.a.statusText:""}catch(u){a=""}t.f=a+" ["+t.W()+"]",mr(t)}}finally{wr(t)}}}function wr(t,e){if(t.a){Er(t);var n=t.a,r=t.u[0]?rt:null;t.a=null,t.u=null,e||Ee(t,"ready");try{n.onreadystatechange=r}catch(ld){}}}function Er(t){t.a&&t.F&&(t.a.ontimeout=null),t.o&&(nt.clearTimeout(t.o),t.o=null)}function Ir(t){return t.a?t.a.readyState:0}function Tr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return At(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Fn(t,e,n))}function _r(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Sr(t){this.qa=0,this.g=[],this.c=new Ke,this.ha=this.ma=this.B=this.ga=this.a=this.oa=this.A=this.V=this.i=this.O=this.l=null,this.Pa=this.R=0,this.Ma=_r("failFast",!1,t),this.G=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.pa=this.P=-1,this.T=this.o=this.u=0,this.Ia=_r("baseRetryDelayMs",5e3,t),this.Sa=_r("retryDelaySeedMs",1e4,t),this.Na=_r("forwardChannelMaxRetries",2,t),this.na=_r("forwardChannelRequestTimeoutMs",2e4,t),this.Oa=t&&t.xmlHttpFactory||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Zn(t&&t.concurrentRequestLimit),this.la=new ur,this.ea=t&&t.fastHandshake||!1,this.Ja=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.ea&&this.S&&t&&t.detectBufferingProxy||!1,this.fa=void 0,this.N=0,this.F=!1,this.s=null,(this.La=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Ar(t){if(Dr(t),3==t.v){var e=t.R++,n=Rn(t.B);Fn(n,"SID",t.J),Fn(n,"RID",e),Fn(n,"TYPE","terminate"),xr(t,n),(e=new ln(t,t.c,e,void 0)).G=2,e.i=Mn(Rn(n)),n=!1,nt.navigator&&nt.navigator.sendBeacon&&(n=nt.navigator.sendBeacon(e.i.toString(),"")),!n&&nt.Image&&((new Image).src=e.i,n=!0),n||(e.a=Gr(e.g,null),e.a.ba(e.i)),e.u=ft(),bn(e)}jr(t)}function Nr(t){t.a&&(Fr(t),t.a.cancel(),t.a=null)}function Dr(t){Nr(t),t.j&&(nt.clearTimeout(t.j),t.j=null),Vr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&nt.clearTimeout(t.h),t.h=null)}function Cr(t,e){t.g.push(new Jn(t.Pa++,e)),3==t.v&&kr(t)}function kr(t){er(t.b)||t.h||(t.h=!0,ke(t.Ca,t),t.u=0)}function Rr(t,e){var n;n=e?e.f:t.R++;var r=Rn(t.B);Fn(r,"SID",t.J),Fn(r,"RID",n),Fn(r,"AID",t.P),xr(t,r),t.i&&t.l&&Tr(r,t.i,t.l),n=new ln(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Or(t,n,1e3),n.setTimeout(Math.round(.5*t.na)+Math.round(.5*t.na*Math.random())),ir(t.b,n),yn(n,r,e)}function xr(t,e){t.f&&Sn({},(function(t,n){Fn(e,n,t)}))}function Or(t,e,n){n=Math.min(t.g.length,n);var r=t.f?ht(t.f.Ka,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{cr(h,s,"req"+c+"_")}catch(l){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Lr(t){t.a||t.j||(t.T=1,ke(t.Ba,t),t.o=0)}function Pr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ze(ht(t.Ba,t),qr(t,t.o)),t.o++,!0)}function Fr(t){null!=t.s&&(nt.clearTimeout(t.s),t.s=null)}function Mr(t){t.a=new ln(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Rn(t.ma);Fn(e,"RID","rpc"),Fn(e,"SID",t.J),Fn(e,"CI",t.G?"0":"1"),Fn(e,"AID",t.P),xr(t,e),Fn(e,"TYPE","xmlhttp"),t.i&&t.l&&Tr(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ha,n.G=1,n.i=Mn(Rn(e)),n.j=null,n.I=!0,vn(n,t)}function Vr(t){null!=t.m&&(nt.clearTimeout(t.m),t.m=null)}function Ur(t,e){var n=null;if(t.a==e){Vr(t),Fr(t),t.a=null;var r=2}else{if(!rr(t.b,e))return;n=e.s,or(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=ft()-e.u;var i=t.u;Ee(r=Qe(),new Je(r,n,e,i)),kr(t)}else Lr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(nr(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ma?0:t.Na)||(t.h=Ze(ht(t.Ca,t,e),qr(t,t.u)),t.u++,0)))}(t,e)||2==r&&Pr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Br(t,5);break;case 4:Br(t,10);break;case 3:Br(t,6);break;default:Br(t,2)}}function qr(t,e){var n=t.Ia+Math.floor(Math.random()*t.Sa);return t.f||(n*=2),n*e}function Br(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=ht(t.cb,t);n||(n=new kn("//www.google.com/images/cleardot.gif"),nt.location&&"http"==nt.location.protocol||xn(n,"https"),Mn(n)),function(t,e){var n=new Ke;if(nt.Image){var r=new Image;r.onload=lt(hr,n,r,"TestLoadImage: loaded",!0,e),r.onerror=lt(hr,n,r,"TestLoadImage: error",!1,e),r.onabort=lt(hr,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=lt(hr,n,r,"TestLoadImage: timeout",!1,e),nt.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else $e(2);t.v=0,t.f&&t.f.sa(e),jr(t),Dr(t)}function jr(t){t.v=0,t.I=-1,t.f&&(0==sr(t.b).length&&0==t.g.length||(t.b.c.length=0,mt(t.g),t.g.length=0),t.f.ra())}function Kr(t,e,n){var r=function(t){return t instanceof kn?Rn(t):new kn(t,void 0)}(n);if(""!=r.c)e&&On(r,e+"."+r.c),Ln(r,r.h);else{var i=nt.location;r=function(t,e,n,r){var i=new kn(null,void 0);return t&&xn(i,t),e&&On(i,e),n&&Ln(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&At(t.V,(function(t,e){Fn(r,e,t)})),e=t.A,n=t.oa,e&&n&&Fn(r,e,n),Fn(r,"VER",t.ia),xr(t,r),r}function Gr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new fr(t.Oa)).G=t.C,e}function zr(){}function Hr(){if(Lt&&!(10<=Number(Qt)))throw Error("Environmental error: no available transport.")}function Qr(t,e){we.call(this),this.a=new Sr(e),this.g=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!bt(t)&&(this.a.i=t),this.o=e&&e.supportsCrossDomainXhr||!1,this.m=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!bt(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new Xr(this)}function Wr(t){un.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Yr(){cn.call(this),this.status=1}function Xr(t){this.a=t}function $r(t){this.f=t}function Jr(t){we.call(this),this.u=t,this.h=void 0,this.readyState=Zr,this.status=0,this.responseType=this.responseText=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.o="",this.a=!1,this.m=this.f=this.g=null}(Z=fr.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.C+"; newUri="+t);e=e?e.toUpperCase():"GET",this.C=t,this.f="",this.h=0,this.A=!1,this.b=!0,this.a=this.l?this.l.a():sn.a(),this.u=this.l?rn(this.l):rn(sn),this.a.onreadystatechange=ht(this.Aa,this);try{this.B=!0,this.a.open(e,String(t),!0),this.B=!1}catch(o){return void gr(this,o)}t=n||"";var i=new An(this.headers);r&&Sn(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=vr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=nt.FormData&&t instanceof nt.FormData,!(0<=yt(yr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.G&&(this.a.withCredentials=this.G);try{Er(this),0<this.s&&((this.F=function(t){return Lt&&zt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.s,this.a.ontimeout=ht(this.ya,this)):this.o=Fe(this.ya,this.s,this)),this.m=!0,this.a.send(t),this.m=!1}catch(o){gr(this,o)}},Z.ya=function(){void 0!==et&&this.a&&(this.f="Timed out after "+this.s+"ms, aborting",this.h=8,Ee(this,"timeout"),this.abort(8))},Z.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ee(this,"complete"),Ee(this,"abort"),wr(this))},Z.H=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),wr(this,!0)),fr.X.H.call(this)},Z.Aa=function(){this.j||(this.B||this.m||this.g?br(this):this.Za())},Z.Za=function(){br(this)},Z.W=function(){try{return 2<Ir(this)?this.a.status:-1}catch(xt){return-1}},Z.$=function(){try{return this.a?this.a.responseText:""}catch(xt){return""}},Z.Qa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),lr(e)}},Z.va=function(){return this.h},Z.Ra=function(){return"string"==typeof this.f?this.f:String(this.f)},(Z=Sr.prototype).ia=8,Z.v=1,Z.Ca=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ln(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Ct(r=Nt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.ea)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Or(this,n,e),Fn(i=Rn(this.B),"RID",t),Fn(i,"CVER",22),this.A&&Fn(i,"X-HTTP-Session-Id",this.A),xr(this,i),this.i&&r&&Tr(i,this.i,r),ir(this.b,n),this.Ja&&Fn(i,"TYPE","init"),this.ea?(Fn(i,"$req",e),Fn(i,"SID","null"),n.U=!0,yn(n,i,null)):yn(n,i,e),this.v=2}}else 3==this.v&&(t?Rr(this,t):0==this.g.length||er(this.b)||Rr(this))},Z.Ba=function(){if(this.j=null,Mr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Ze(ht(this.Ya,this),t)}},Z.Ya=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.F=!0,$e(10),Nr(this),Mr(this))},Z.Xa=function(){null!=this.m&&(this.m=null,Nr(this),Pr(this),$e(19))},Z.cb=function(t){t?(this.c.info("Successfully pinged google.com"),$e(2)):(this.c.info("Failed to ping google.com"),$e(1))},(Z=zr.prototype).ua=function(){},Z.ta=function(){},Z.sa=function(){},Z.ra=function(){},Z.Ka=function(){},Hr.prototype.a=function(t,e){return new Qr(t,e)},pt(Qr,we),Qr.prototype.h=function(){this.a.f=this.f,this.o&&(this.a.C=!0);var t=this.a,e=this.g,n=this.b||void 0;$e(0),t.ga=e,t.V=n||{},t.G=t.S,t.B=Kr(t,null,t.ga),kr(t)},Qr.prototype.close=function(){Ar(this.a)},Qr.prototype.l=function(t){if("string"==typeof t){var e={};e.__data__=t,Cr(this.a,e)}else this.m?((e={}).__data__=Te(t),Cr(this.a,e)):Cr(this.a,t)},Qr.prototype.H=function(){this.a.f=null,delete this.f,Ar(this.a),delete this.a,Qr.X.H.call(this)},pt(Wr,un),pt(Yr,cn),pt(Xr,zr),Xr.prototype.ua=function(){Ee(this.a,"a")},Xr.prototype.ta=function(t){Ee(this.a,new Wr(t))},Xr.prototype.sa=function(t){Ee(this.a,new Yr(t))},Xr.prototype.ra=function(){Ee(this.a,"b")},pt($r,nn),$r.prototype.a=function(){return new Jr(this.f)},$r.prototype.c=function(t){return function(){return t}}({}),pt(Jr,we);var Zr=0;function ti(t){t.f.read().then(t.Ta.bind(t)).catch(t.ca.bind(t))}function ei(t){t.readyState=4,t.g=null,t.f=null,t.m=null,ni(t)}function ni(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Z=Jr.prototype).open=function(t,e){if(this.readyState!=Zr)throw this.abort(),Error("Error reopening a connection");this.s=t,this.o=e,this.readyState=1,ni(this)},Z.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.o,e)).then(this.Wa.bind(this),this.ca.bind(this))},Z.abort=function(){this.responseText="",this.l=new Headers,this.status=0,this.f&&this.f.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,ei(this)),this.readyState=Zr},Z.Wa=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,ni(this)),this.a&&(this.readyState=3,ni(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.Ua.bind(this),this.ca.bind(this)):void 0!==nt.ReadableStream&&"body"in t?(this.responseText="",this.f=t.body.getReader(),this.m=new TextDecoder,ti(this)):t.text().then(this.Va.bind(this),this.ca.bind(this)))))},Z.Ta=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.responseText+=e),t.done?ei(this):ni(this),3==this.readyState&&ti(this)}},Z.Va=function(t){this.a&&(this.responseText=t,ei(this))},Z.Ua=function(){this.a&&ei(this)},Z.ca=function(){this.a&&ei(this)},Z.setRequestHeader=function(t,e){this.l.append(t,e)},Z.getResponseHeader=function(t){return this.b&&this.b.get(t.toLowerCase())||""},Z.getAllResponseHeaders=function(){if(!this.b)return"";for(var t=[],e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Jr.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),Hr.prototype.createWebChannel=Hr.prototype.a,Qr.prototype.send=Qr.prototype.l,Qr.prototype.open=Qr.prototype.h,Qr.prototype.close=Qr.prototype.close,tn.NO_ERROR=0,tn.TIMEOUT=8,tn.HTTP_ERROR=6,en.COMPLETE="complete",on.EventType=an,an.OPEN="a",an.CLOSE="b",an.ERROR="c",an.MESSAGE="d",we.prototype.listen=we.prototype.wa,fr.prototype.listenOnce=fr.prototype.xa,fr.prototype.getLastError=fr.prototype.Ra,fr.prototype.getLastErrorCode=fr.prototype.va,fr.prototype.getStatus=fr.prototype.W,fr.prototype.getResponseJson=fr.prototype.Qa,fr.prototype.getResponseText=fr.prototype.$,fr.prototype.send=fr.prototype.ba;var ri=tn,ii=en,oi=ze,si=10,ai=11,ui=$r,ci=on,hi=fr,li=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();li.o=-1;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var fi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},pi=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return e(n,t),n}(Error),di=new P("@firebase/firestore");function yi(){return di.logLevel}function vi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(di.logLevel<=N.DEBUG){var r=e.map(bi);di.debug.apply(di,a(["Firestore (8.6.7): "+t],r))}}function gi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(di.logLevel<=N.ERROR){var r=e.map(bi);di.error.apply(di,a(["Firestore (8.6.7): "+t],r))}}function mi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(di.logLevel<=N.WARN){var r=e.map(bi);di.warn.apply(di,a(["Firestore (8.6.7): "+t],r))}}function bi(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(n){return t}var e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wi(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.6.7) INTERNAL ASSERTION FAILED: "+t;throw gi(e),new Error(e)}function Ei(t,e){t||wi()}function Ii(t,e){return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _i=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Ti(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Si(t,e){return t<e?-1:t>e?1:0}function Ai(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Ni(t){return t+"\0"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Di=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new pi(fi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new pi(fi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new pi(fi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new pi(fi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Si(this.nanoseconds,t.nanoseconds):Si(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Ci=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Di(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ri(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function xi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&wi(),void 0===n?n=t.length-e:n>t.length-e&&wi(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Li=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.construct=function(t,e,r){return new n(t,e,r)},n.prototype.canonicalString=function(){return this.toArray().join("/")},n.prototype.toString=function(){return this.canonicalString()},n.fromString=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new pi(fi.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new n(r)},n.emptyPath=function(){return new n([])},n}(Oi),Pi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Fi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.construct=function(t,e,r){return new n(t,e,r)},n.isValidIdentifier=function(t){return Pi.test(t)},n.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},n.prototype.toString=function(){return this.canonicalString()},n.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},n.keyField=function(){return new n(["__name__"])},n.fromServerFormat=function(t){for(var e=[],r="",i=0,o=function(){if(0===r.length)throw new pi(fi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new pi(fi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new pi(fi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new pi(fi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new n(e)},n.emptyPath=function(){return new n([])},n}(Oi),Mi=function(){function t(t){this.fields=t,t.sort(Fi.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Ai(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Vi=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Si(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Vi.EMPTY_BYTE_STRING=new Vi("");var Ui=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qi(t){if(Ei(!!t),"string"==typeof t){var e=0,n=Ui.exec(t);if(Ei(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Bi(t.seconds),nanos:Bi(t.nanos)}}function Bi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ji(t){return"string"==typeof t?Vi.fromBase64String(t):Vi.fromUint8Array(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ki(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Gi(t){var e=t.mapValue.fields.__previous_value__;return Ki(e)?Gi(e):e}function zi(t){var e=qi(t.mapValue.fields.__local_write_time__.timestampValue);return new Di(e.seconds,e.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hi(t){return null==t}function Qi(t){return 0===t&&1/t==-1/0}function Wi(t){return"number"==typeof t&&Number.isInteger(t)&&!Qi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yi=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(Li.fromString(e))},t.fromName=function(e){return new t(Li.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Li.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return Li.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new Li(e.slice()))},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ki(t)?4:10:wi()}function $i(t,e){var n,r=Xi(t);if(r!==Xi(e))return!1;switch(r){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zi(t).isEqual(zi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=qi(t.timestampValue),r=qi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return n=e,ji(t.bytesValue).isEqual(ji(n.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Bi(t.geoPointValue.latitude)===Bi(e.geoPointValue.latitude)&&Bi(t.geoPointValue.longitude)===Bi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Bi(t.integerValue)===Bi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Bi(t.doubleValue),r=Bi(e.doubleValue);return n===r?Qi(n)===Qi(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Ai(t.arrayValue.values||[],e.arrayValue.values||[],$i);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(ki(n)!==ki(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!$i(n[i],r[i])))return!1;return!0}(t,e);default:return wi()}}function Ji(t,e){return void 0!==(t.values||[]).find((function(t){return $i(t,e)}))}function Zi(t,e){var n,r,i,o,s=Xi(t),a=Xi(e);if(s!==a)return Si(s,a);switch(s){case 0:return 0;case 1:return Si(t.booleanValue,e.booleanValue);case 2:return r=e,i=Bi((n=t).integerValue||n.doubleValue),o=Bi(r.integerValue||r.doubleValue),i<o?-1:i>o?1:i===o?0:isNaN(i)?isNaN(o)?0:-1:1;case 3:return to(t.timestampValue,e.timestampValue);case 4:return to(zi(t),zi(e));case 5:return Si(t.stringValue,e.stringValue);case 6:return function(t,e){var n=ji(t),r=ji(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Si(n[i],r[i]);if(0!==o)return o}return Si(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Si(Bi(t.latitude),Bi(e.latitude));return 0!==n?n:Si(Bi(t.longitude),Bi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Zi(n[i],r[i]);if(o)return o}return Si(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Si(r[s],o[s]);if(0!==a)return a;var u=Zi(n[r[s]],i[o[s]]);if(0!==u)return u}return Si(r.length,o.length)}(t.mapValue,e.mapValue);default:throw wi()}}function to(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Si(t,e);var n=qi(t),r=qi(e),i=Si(n.seconds,r.seconds);return 0!==i?i:Si(n.nanos,r.nanos)}function eo(t){return no(t)}function no(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(e=t.timestampValue,"time("+(n=qi(e)).seconds+","+n.nanos+")"):"stringValue"in t?t.stringValue:"bytesValue"in t?ji(t.bytesValue).toBase64():"referenceValue"in t?(i=t.referenceValue,Yi.fromName(i).toString()):"geoPointValue"in t?"geo("+(r=t.geoPointValue).latitude+","+r.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=no(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+no(t.fields[o])}return e+"}"}(t.mapValue):wi();var e,n,r,i}function ro(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function io(t){return!!t&&"integerValue"in t}function oo(t){return!!t&&"arrayValue"in t}function so(t){return!!t&&"nullValue"in t}function ao(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function uo(t){return!!t&&"mapValue"in t}function co(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},qi(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return Ri(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=co(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=co(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ho=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!uo(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=co(e)},t.prototype.setAll=function(t){var e=this,n=Fi.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=co(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());uo(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return $i(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];uo(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){Ri(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(co(this.value))},t}();function lo(t){var e=[];return Ri(t.fields,(function(t,n){var r=new Fi([t]);if(uo(n)){var i=lo(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new Mi(e)}var fo=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,Ci.min(),ho.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,ho.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,ho.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=ho.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=ho.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),po=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new po(t,e,n,r,i,o,s)}function vo(t){var e=Ii(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return(e=t).field.canonicalString()+e.op.toString()+eo(e.value);var e})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.canonicalString()+e.dir;var e})).join(","),Hi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Co(e.startAt)),e.endAt&&(n+="|ub:",n+=Co(e.endAt)),e.h=n}return e.h}function go(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Ro(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!$i(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Oo(t.startAt,e.startAt)&&Oo(t.endAt,e.endAt)}function mo(t){return Yi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var bo=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return e(n,t),n.create=function(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.l(t,e,r):new wo(t,e,r):"array-contains"===e?new _o(t,r):"in"===e?new So(t,r):"not-in"===e?new Ao(t,r):"array-contains-any"===e?new No(t,r):new n(t,e,r)},n.l=function(t,e,n){return"in"===e?new Eo(t,n):new Io(t,n)},n.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Zi(e,this.value)):null!==e&&Xi(this.value)===Xi(e)&&this.m(Zi(e,this.value))},n.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return wi()}},n.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},n}((function(){})),wo=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Yi.fromName(r.referenceValue),i}return e(n,t),n.prototype.matches=function(t){var e=Yi.comparator(t.key,this.key);return this.m(e)},n}(bo),Eo=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=To("in",n),r}return e(n,t),n.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},n}(bo),Io=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=To("not-in",n),r}return e(n,t),n.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},n}(bo);function To(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Yi.fromName(t.referenceValue)}))}var _o=function(t){function n(e,n){return t.call(this,e,"array-contains",n)||this}return e(n,t),n.prototype.matches=function(t){var e=t.data.field(this.field);return oo(e)&&Ji(e.arrayValue,this.value)},n}(bo),So=function(t){function n(e,n){return t.call(this,e,"in",n)||this}return e(n,t),n.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Ji(this.value.arrayValue,e)},n}(bo),Ao=function(t){function n(e,n){return t.call(this,e,"not-in",n)||this}return e(n,t),n.prototype.matches=function(t){if(Ji(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Ji(this.value.arrayValue,e)},n}(bo),No=function(t){function n(e,n){return t.call(this,e,"array-contains-any",n)||this}return e(n,t),n.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!oo(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Ji(e.value.arrayValue,t)}))},n}(bo),Do=function(t,e){this.position=t,this.before=e};function Co(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return eo(t)})).join(",")}var ko=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ro(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function xo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Yi.comparator(Yi.fromName(s.referenceValue),n.key):Zi(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Oo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!$i(t.position[n],e.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lo=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function Po(t,e,n,r,i,o,s,a){return new Lo(t,e,n,r,i,o,s,a)}function Fo(t){return new Lo(t)}function Mo(t){return!Hi(t.limit)&&"F"===t.limitType}function Vo(t){return!Hi(t.limit)&&"L"===t.limitType}function Uo(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function qo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Bo(t){return null!==t.collectionGroup}function jo(t){var e=Ii(t);if(null===e.p){e.p=[];var n=qo(e),r=Uo(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new ko(n)),e.p.push(new ko(Fi.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new ko(Fi.keyField(),u))}}}return e.p}function Ko(t){var e=Ii(t);if(!e.T)if("F"===e.limitType)e.T=yo(e.path,e.collectionGroup,jo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=jo(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ko(o.field,s))}var a=e.endAt?new Do(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Do(e.startAt.position,!e.startAt.before):null;e.T=yo(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function Go(t,e,n){return new Lo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function zo(t,e){return go(Ko(t),Ko(e))&&t.limitType===e.limitType}function Ho(t){return vo(Ko(t))+"|lt:"+t.limitType}function Qo(t){return"Query(target="+(e=Ko(t),n=e.path.canonicalString(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=", filters: ["+e.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+eo(e.value);var e})).join(", ")+"]"),Hi(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=", orderBy: ["+e.orderBy.map((function(t){return(e=t).field.canonicalString()+" ("+e.dir+")";var e})).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Co(e.startAt)),e.endAt&&(n+=", endAt: "+Co(e.endAt)),"Target("+n+"); limitType=")+t.limitType+")";var e,n}function Wo(t,e){return e.isFoundDocument()&&(n=t,i=(r=e).key.path,null!==n.collectionGroup?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Yi.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i))&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!xo(t.startAt,jo(t),e)||t.endAt&&xo(t.endAt,jo(t),e))}(t,e);var n,r,i}function Yo(t){return function(e,n){for(var r=!1,i=0,o=jo(t);i<o.length;i++){var s=o[i],a=Xo(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Xo(t,e,n){var r,i,o,s,a=t.field.isKeyField()?Yi.comparator(e.key,n.key):(r=t.field,i=n,o=e.data.field(r),s=i.data.field(r),null!==o&&null!==s?Zi(o,s):wi());switch(t.dir){case"asc":return a;case"desc":return-1*a;default:return wi()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $o(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qi(e)?"-0":e}}function Jo(t){return{integerValue:""+t}}function Zo(t,e){return Wi(e)?Jo(e):$o(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ts=function(){this._=void 0};function es(t,e,n){return t instanceof is?(i=e,o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(o.fields.__previous_value__=i),{mapValue:o}):t instanceof os?ss(t,e):t instanceof as?us(t,e):function(t,e){var n=rs(t,e),r=hs(n)+hs(t.A);return io(n)&&io(t.A)?Jo(r):$o(t.R,r)}(t,e);var r,i,o}function ns(t,e,n){return t instanceof os?ss(t,e):t instanceof as?us(t,e):n}function rs(t,e){return t instanceof cs?io(r=e)||(n=r)&&"doubleValue"in n?e:{integerValue:0}:null;var n,r}var is=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n}(ts),os=function(t){function n(e){var n=this;return(n=t.call(this)||this).elements=e,n}return e(n,t),n}(ts);function ss(t,e){for(var n=ls(e),r=function(t){n.some((function(e){return $i(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var as=function(t){function n(e){var n=this;return(n=t.call(this)||this).elements=e,n}return e(n,t),n}(ts);function us(t,e){for(var n=ls(e),r=function(t){n=n.filter((function(e){return!$i(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var cs=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return e(n,t),n}(ts);function hs(t){return Bi(t.integerValue||t.doubleValue)}function ls(t){return oo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fs=function(t,e){this.field=t,this.transform=e},ps=function(t,e){this.version=t,this.transformResults=e},ds=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function ys(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var vs=function(){};function gs(t,e,n){var r,i,o,s,a;t instanceof Is?(i=e,o=n,s=(r=t).value.clone(),a=Ss(r.fieldTransforms,i,o.transformResults),s.setAll(a),i.convertToFoundDocument(o.version,s).setHasCommittedMutations()):t instanceof Ts?function(t,e,n){if(ys(t.precondition,e)){var r=Ss(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(_s(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function ms(t,e,n){var r;t instanceof Is?function(t,e,n){if(ys(t.precondition,e)){var r=t.value.clone(),i=As(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Es(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Ts?function(t,e,n){if(ys(t.precondition,e)){var r=As(t.fieldTransforms,n,e),i=e.data;i.setAll(_s(t)),i.setAll(r),e.convertToFoundDocument(Es(e),i).setHasLocalMutations()}}(t,e,n):(r=e,ys(t.precondition,r)&&r.convertToNoDocument(Ci.min()))}function bs(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=rs(o.transform,s||null);null!=a&&(null==n&&(n=ho.empty()),n.set(o.field,a))}return n||null}function ws(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Ai(n,r,(function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof os&&o instanceof os||i instanceof as&&o instanceof as?Ai(i.elements,o.elements,$i):i instanceof cs&&o instanceof cs?$i(i.A,o.A):i instanceof is&&o instanceof is);var n,r,i,o}))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var n,r}function Es(t){return t.isFoundDocument()?t.version:Ci.min()}var Is=function(t){function n(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return e(n,t),n}(vs),Ts=function(t){function n(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return e(n,t),n}(vs);function _s(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Ss(t,e,n){var r=new Map;Ei(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,ns(s,a,n[i]))}return r}function As(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,es(a,u,e))}return r}var Ns,Ds,Cs=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return e(n,t),n}(vs),ks=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return e(n,t),n}(vs),Rs=function(t){this.count=t};function xs(t){switch(t){case fi.OK:return wi();case fi.CANCELLED:case fi.UNKNOWN:case fi.DEADLINE_EXCEEDED:case fi.RESOURCE_EXHAUSTED:case fi.INTERNAL:case fi.UNAVAILABLE:case fi.UNAUTHENTICATED:return!1;case fi.INVALID_ARGUMENT:case fi.NOT_FOUND:case fi.ALREADY_EXISTS:case fi.PERMISSION_DENIED:case fi.FAILED_PRECONDITION:case fi.ABORTED:case fi.OUT_OF_RANGE:case fi.UNIMPLEMENTED:case fi.DATA_LOSS:return!0;default:return wi()}}function Os(t){if(void 0===t)return gi("GRPC error has no .code"),fi.UNKNOWN;switch(t){case Ns.OK:return fi.OK;case Ns.CANCELLED:return fi.CANCELLED;case Ns.UNKNOWN:return fi.UNKNOWN;case Ns.DEADLINE_EXCEEDED:return fi.DEADLINE_EXCEEDED;case Ns.RESOURCE_EXHAUSTED:return fi.RESOURCE_EXHAUSTED;case Ns.INTERNAL:return fi.INTERNAL;case Ns.UNAVAILABLE:return fi.UNAVAILABLE;case Ns.UNAUTHENTICATED:return fi.UNAUTHENTICATED;case Ns.INVALID_ARGUMENT:return fi.INVALID_ARGUMENT;case Ns.NOT_FOUND:return fi.NOT_FOUND;case Ns.ALREADY_EXISTS:return fi.ALREADY_EXISTS;case Ns.PERMISSION_DENIED:return fi.PERMISSION_DENIED;case Ns.FAILED_PRECONDITION:return fi.FAILED_PRECONDITION;case Ns.ABORTED:return fi.ABORTED;case Ns.OUT_OF_RANGE:return fi.OUT_OF_RANGE;case Ns.UNIMPLEMENTED:return fi.UNIMPLEMENTED;case Ns.DATA_LOSS:return fi.DATA_LOSS;default:return wi()}}(Ds=Ns||(Ns={}))[Ds.OK=0]="OK",Ds[Ds.CANCELLED=1]="CANCELLED",Ds[Ds.UNKNOWN=2]="UNKNOWN",Ds[Ds.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ds[Ds.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ds[Ds.NOT_FOUND=5]="NOT_FOUND",Ds[Ds.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ds[Ds.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ds[Ds.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ds[Ds.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ds[Ds.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ds[Ds.ABORTED=10]="ABORTED",Ds[Ds.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ds[Ds.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ds[Ds.INTERNAL=13]="INTERNAL",Ds[Ds.UNAVAILABLE=14]="UNAVAILABLE",Ds[Ds.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ls=function(){function t(t,e){this.comparator=t,this.root=e||Fs.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Fs.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fs.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Ps(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Ps(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Ps(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Ps(this.root,t,this.comparator,!0)},t}(),Ps=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Fs=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw wi();if(this.right.isRed())throw wi();var t=this.left.check();if(t!==this.right.check())throw wi();return t+(this.isRed()?0:1)},t}();Fs.EMPTY=null,Fs.RED=!0,Fs.BLACK=!1,Fs.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw wi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw wi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw wi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw wi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw wi()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Fs(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ms=function(){function t(t){this.comparator=t,this.data=new Ls(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Vs(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Vs(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Vs=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Us=new Ls(Yi.comparator);function qs(){return Us}var Bs=new Ls(Yi.comparator);function js(){return Bs}var Ks=new Ls(Yi.comparator);var Gs=new Ms(Yi.comparator);function zs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Gs,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Hs=new Ms(Si);function Qs(){return Hs}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ws=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Ys.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(Ci.min(),r,Qs(),qs(),zs())},t}(),Ys=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Vi.EMPTY_BYTE_STRING,n,zs(),zs(),zs())},t}(),Xs=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},$s=function(t,e){this.targetId=t,this.V=e},Js=function(t,e,n,r){void 0===n&&(n=Vi.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Zs=function(){function t(){this.S=0,this.D=na(),this.C=Vi.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=zs(),e=zs(),n=zs();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:wi()}})),new Ys(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=na()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),ta=function(){function t(t){this.W=t,this.G=new Map,this.H=qs(),this.J=ea(),this.Y=new Ms(Si)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:wi()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(mo(i))if(0===n){var o=new Yi(i.path);this.tt(e,o,fo.newNoDocument(o,Ci.min()))}else Ei(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&mo(o.target)){var s=new Yi(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,fo.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=zs();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Ws(t,n,this.Y,this.H,r);return this.H=qs(),this.J=ea(),this.Y=new Ms(Si),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Zs,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Ms(Si),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||vi("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Zs),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function ea(){return new Ls(Yi.comparator)}function na(){return new Ls(Yi.comparator)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ra={asc:"ASCENDING",desc:"DESCENDING"},ia={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},oa=function(t,e){this.databaseId=t,this.I=e};function sa(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function aa(t,e){return t.I?e.toBase64():e.toUint8Array()}function ua(t,e){return sa(t,e.toTimestamp())}function ca(t){return Ei(!!t),Ci.fromTimestamp((e=qi(t),new Di(e.seconds,e.nanos)));var e}function ha(t,e){return(n=t,new Li(["projects",n.projectId,"databases",n.database])).child("documents").child(e).canonicalString();var n}function la(t){var e=Li.fromString(t);return Ei(La(e)),e}function fa(t,e){return ha(t.databaseId,e.path)}function pa(t,e){var n=la(e);if(n.get(1)!==t.databaseId.projectId)throw new pi(fi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new pi(fi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Yi(ga(n))}function da(t,e){return ha(t.databaseId,e)}function ya(t){var e=la(t);return 4===e.length?Li.emptyPath():ga(e)}function va(t){return new Li(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ga(t){return Ei(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function ma(t,e,n){return{name:fa(t,e),fields:n.value.mapValue.fields}}function ba(t,e){var n,r,i;if(e instanceof Is)n={update:ma(t,e.key,e.value)};else if(e instanceof Cs)n={delete:fa(t,e.key)};else if(e instanceof Ts)n={update:ma(t,e.key,e.data),updateMask:Oa(e.fieldMask)};else{if(!(e instanceof ks))return wi();n={verify:fa(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof is)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof os)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof as)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof cs)return{fieldPath:e.field.canonicalString(),increment:n.A};throw wi()}(0,t)}))),e.precondition.isNone||(n.currentDocument=(r=t,void 0!==(i=e.precondition).updateTime?{updateTime:ua(r,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:wi())),n}function wa(t,e){var n,r=e.currentDocument?void 0!==(n=e.currentDocument).updateTime?ds.updateTime(ca(n.updateTime)):void 0!==n.exists?ds.exists(n.exists):ds.none():ds.none(),i=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Ei("REQUEST_TIME"===e.setToServerValue),n=new is;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new os(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new as(i)}else"increment"in e?n=new cs(t,e.increment):wi();var o=Fi.fromServerFormat(e.fieldPath);return new fs(o,n)}(t,e)})):[];if(e.update){e.update.name;var o=pa(t,e.update.name),s=new ho({mapValue:{fields:e.update.fields}});if(e.updateMask){var a=function(t){var e=t.fieldPaths||[];return new Mi(e.map((function(t){return Fi.fromServerFormat(t)})))}(e.updateMask);return new Ts(o,s,a,r,i)}return new Is(o,s,r,i)}if(e.delete){var u=pa(t,e.delete);return new Cs(u,r)}if(e.verify){var c=pa(t,e.verify);return new ks(c,r)}return wi()}function Ea(t,e){return{documents:[da(t,e.path)]}}function Ia(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=da(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=da(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(ao(t.value))return{unaryFilter:{field:Ca(t.field),op:"IS_NAN"}};if(so(t.value))return{unaryFilter:{field:Ca(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ao(t.value))return{unaryFilter:{field:Ca(t.field),op:"IS_NOT_NAN"}};if(so(t.value))return{unaryFilter:{field:Ca(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ca(t.field),op:Da(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return{field:Ca((e=t).field),direction:Na(e.dir)};var e}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,a,u=(s=t,a=e.limit,s.I||Hi(a)?a:{value:a});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Sa(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Sa(e.endAt)),n}function Ta(t){var e=ya(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Ei(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=_a(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return new ko(ka((e=t).field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction));var e})));var u,c,h=null;n.limit&&(u=n.limit,h=Hi(c="object"==typeof u?u.value:u)?null:c);var l=null;n.startAt&&(l=Aa(n.startAt));var f=null;return n.endAt&&(f=Aa(n.endAt)),Po(e,i,a,s,h,"F",l,f)}function _a(t){return t?void 0!==t.unaryFilter?[xa(t)]:void 0!==t.fieldFilter?[Ra(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return _a(t)})).reduce((function(t,e){return t.concat(e)})):wi():[]}function Sa(t){return{before:t.before,values:t.position}}function Aa(t){var e=!!t.before,n=t.values||[];return new Do(n,e)}function Na(t){return ra[t]}function Da(t){return ia[t]}function Ca(t){return{fieldPath:t.canonicalString()}}function ka(t){return Fi.fromServerFormat(t.fieldPath)}function Ra(t){return bo.create(ka(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return wi()}}(t.fieldFilter.op),t.fieldFilter.value)}function xa(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ka(t.unaryFilter.field);return bo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ka(t.unaryFilter.field);return bo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ka(t.unaryFilter.field);return bo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ka(t.unaryFilter.field);return bo.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return wi()}}function Oa(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function La(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pa(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Ma(e)),e=Fa(t.get(n),e);return Ma(e)}function Fa(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Ma(t){return t+""}function Va(t){var e=t.length;if(Ei(e>=2),2===e)return Ei(""===t.charAt(0)&&""===t.charAt(1)),Li.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&wi(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:wi()}o=s+2}return new Li(r)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ua=function(t,e){this.seconds=t,this.nanoseconds=e},qa=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};qa.store="owner",qa.key="owner";var Ba=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ba.store="mutationQueues",Ba.keyPath="userId";var ja=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};ja.store="mutations",ja.keyPath="batchId",ja.userMutationsIndex="userMutationsIndex",ja.userMutationsKeyPath=["userId","batchId"];var Ka=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Pa(e)]},t.key=function(t,e,n){return[t,Pa(e),n]},t}();Ka.store="documentMutations",Ka.PLACEHOLDER=new Ka;var Ga=function(t,e){this.path=t,this.readTime=e},za=function(t,e){this.path=t,this.version=e},Ha=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ha.store="remoteDocuments",Ha.readTimeIndex="readTimeIndex",Ha.readTimeIndexPath="readTime",Ha.collectionReadTimeIndex="collectionReadTimeIndex",Ha.collectionReadTimeIndexPath=["parentPath","readTime"];var Qa=function(t){this.byteSize=t};Qa.store="remoteDocumentGlobal",Qa.key="remoteDocumentGlobalKey";var Wa=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Wa.store="targets",Wa.keyPath="targetId",Wa.queryTargetsIndexName="queryTargetsIndex",Wa.queryTargetsKeyPath=["canonicalId","targetId"];var Ya=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ya.store="targetDocuments",Ya.keyPath=["targetId","path"],Ya.documentTargetsIndex="documentTargetsIndex",Ya.documentTargetsKeyPath=["path","targetId"];var Xa=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Xa.key="targetGlobalKey",Xa.store="targetGlobal";var $a=function(t,e){this.collectionId=t,this.parent=e};$a.store="collectionParents",$a.keyPath=["collectionId","parent"];var Ja=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ja.store="clientMetadata",Ja.keyPath="clientId";var Za=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Za.store="bundles",Za.keyPath="bundleId";var tu=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};tu.store="namedQueries",tu.keyPath="name";var eu=a(a([],a(a([],a(a([],a(a([],[Ba.store,ja.store,Ka.store,Ha.store,Wa.store,qa.store,Xa.store,Ya.store]),[Ja.store])),[Qa.store])),[$a.store])),[Za.store,tu.store]),nu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ru=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),iu=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},ou=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&wi(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(r){return t.reject(r)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),su=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new iu,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new cu(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=du(e.target.error);n.ft.reject(new cu(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(o){throw new cu(n,o)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(vi("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new lu(e)},t}(),au=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(l())&&gi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return vi("SimpleDb","Removing database:",t),fu(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=l(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return r(this,void 0,void 0,(function(){var e,n=this;return i(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(vi("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new cu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new pi(fi.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new cu(t,n))},i.onupgradeneeded=function(t){vi("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){vi("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s,a,u,c;return i(this,(function(h){switch(h.label){case 0:r="readonly"===e,s=0,a=function(){var e,a,c,h,l;return i(this,(function(i){switch(i.label){case 0:++s,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,u.At(t)];case 2:return u.db=i.sent(),e=su.open(u.db,t,r?"readonly":"readwrite",n),a=o(e).catch((function(t){return e.abort(t),ou.reject(t)})).toPromise(),c={},a.catch((function(){})),[4,e.dt];case 3:return[2,(c.value=(i.sent(),a),c)];case 4:return h=i.sent(),l="FirebaseError"!==h.name&&s<3,vi("SimpleDb","Transaction failed with error:",h.message,"Retrying:",l),u.close(),l?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}}))},u=this,h.label=1;case 1:return[5,a()];case 2:if("object"==typeof(c=h.sent()))return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),uu=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return fu(this.Pt.delete())},t}(),cu=function(t){function n(e,n){var r=this;return(r=t.call(this,fi.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return e(n,t),n}(pi);function hu(t){return"IndexedDbTransactionError"===t.name}var lu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(vi("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(vi("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),fu(n)},t.prototype.add=function(t){return vi("SimpleDb","ADD",this.store.name,t,t),fu(this.store.add(t))},t.prototype.get=function(t){var e=this;return fu(this.store.get(t)).next((function(n){return void 0===n&&(n=null),vi("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return vi("SimpleDb","DELETE",this.store.name,t),fu(this.store.delete(t))},t.prototype.count=function(){return vi("SimpleDb","COUNT",this.store.name),fu(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){vi("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new ou((function(n,r){e.onerror=function(t){var e=du(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new ou((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new uu(i),s=e(i.primaryKey,i.value,o);if(s instanceof ou){var a=s.catch((function(t){return o.done(),ou.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return ou.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function fu(t){return new ou((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=du(t.target.error);n(e)}}))}var pu=!1;function du(t){var e=au._t(l());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new pi("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return pu||(pu=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yu=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return e(n,t),n}(ru);function vu(t,e){var n=Ii(t);return au.It(n.Mt,e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gu=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&gs(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&ms(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&ms(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(Ci.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),zs())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ai(this.mutations,t.mutations,(function(t,e){return ws(t,e)}))&&Ai(this.baseMutations,t.baseMutations,(function(t,e){return ws(t,e)}))},t}(),mu=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Ei(e.mutations.length===r.length);for(var i=Ks,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),bu=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Ci.min()),void 0===o&&(o=Ci.min()),void 0===s&&(s=Vi.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),wu=function(t){this.Lt=t};function Eu(t,e){if(e.document)return function(t,e,n){var r=pa(t,e.name),i=ca(e.updateTime),o=new ho({mapValue:{fields:e.fields}}),s=fo.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Yi.fromSegments(e.noDocument.path),r=Au(e.noDocument.readTime),i=fo.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Yi.fromSegments(e.unknownDocument.path);return r=Au(e.unknownDocument.version),fo.newUnknownDocument(o,r)}return wi()}function Iu(t,e,n){var r,i,o=Tu(n),s=e.key.path.popLast().toArray();if(e.isFoundDocument()){var a={name:fa(r=t.Lt,(i=e).key),fields:i.data.value.mapValue.fields,updateTime:sa(r,i.version.toTimestamp())},u=e.hasCommittedMutations;return new Ha(null,null,a,u,o,s)}if(e.isNoDocument()){var c=e.key.path.toArray(),h=Su(e.version);return u=e.hasCommittedMutations,new Ha(null,new Ga(c,h),null,u,o,s)}if(e.isUnknownDocument()){var l=e.key.path.toArray(),f=Su(e.version);return new Ha(new za(l,f),null,null,!0,o,s)}return wi()}function Tu(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function _u(t){var e=new Di(t[0],t[1]);return Ci.fromTimestamp(e)}function Su(t){var e=t.toTimestamp();return new Ua(e.seconds,e.nanoseconds)}function Au(t){var e=new Di(t.seconds,t.nanoseconds);return Ci.fromTimestamp(e)}function Nu(t,e){for(var n=(e.baseMutations||[]).map((function(e){return wa(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return wa(t.Lt,e)})),a=Di.fromMillis(e.localWriteTimeMs);return new gu(e.batchId,a,n,s)}function Du(t){var e,n,r=Au(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Au(t.lastLimboFreeSnapshotVersion):Ci.min();return void 0!==t.query.documents?(Ei(1===(n=t.query).documents.length),e=Ko(Fo(ya(n.documents[0])))):e=Ko(Ta(t.query)),new bu(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Vi.fromBase64String(t.resumeToken))}function Cu(t,e){var n,r=Su(e.snapshotVersion),i=Su(e.lastLimboFreeSnapshotVersion);n=mo(e.target)?Ea(t.Lt,e.target):Ia(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Wa(e.targetId,vo(e.target),r,o,e.sequenceNumber,i,n)}function ku(t){var e=Ta({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Go(e,e.limit,"L"):e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ru=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return xu(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Au(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return xu(t).put({bundleId:(n=e).id,createTime:Su(ca(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Ou(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:ku(e.bundledQuery),readTime:Au(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return Ou(t).put({name:(n=e).name,readTime:Su(ca(n.readTime)),bundledQuery:n.bundledQuery});var n},t}();function xu(t){return vu(t,Za.store)}function Ou(t){return vu(t,tu.store)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lu=function(){function t(){this.Bt=new Pu}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),ou.resolve()},t.prototype.getCollectionParents=function(t,e){return ou.resolve(this.Bt.getEntries(e))},t}(),Pu=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Ms(Li.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Ms(Li.comparator)).toArray()},t}(),Fu=function(){function t(){this.qt=new Pu}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:Pa(i)};return Mu(t).put(o)}return ou.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Ni(e),""],!1,!0);return Mu(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Va(o.parent))}return n}))},t}();function Mu(t){return vu(t,$a.store)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Uu=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(t,e,n){var r=t.store(ja.store),i=t.store(Ka.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){Ei(1===a)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=Ka.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return ou.waitFor(o).next((function(){return c}))}function Bu(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw wi();e=t.noDocument}return JSON.stringify(e).length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Uu.DEFAULT_COLLECTION_PERCENTILE=10,Uu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Uu.DEFAULT=new Uu(41943040,Uu.DEFAULT_COLLECTION_PERCENTILE,Uu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Uu.DISABLED=new Uu(-1,0,0);var ju=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return t.Kt=function(e,n,r,i){return Ei(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gu(t).$t({index:ja.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=zu(t),s=Gu(t);return s.add({}).next((function(a){Ei("number"==typeof a);for(var u=new gu(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return ba(t.Lt,e)})),i=n.mutations.map((function(e){return ba(t.Lt,e)}));return new ja(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new Ms((function(t,e){return Si(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],y=Ka.key(i.userId,d.key.path,a);l=l.add(d.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,Ka.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Qt[a]=u.keys()})),ou.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Gu(t).get(e).next((function(t){return t?(Ei(t.userId===n.userId),Nu(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Qt[e]?ou.resolve(this.Qt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Qt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Gu(t).$t({index:ja.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Ei(e.batchId>=r),o=Nu(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Gu(t).$t({index:ja.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Gu(t).Nt(ja.userMutationsIndex,n).next((function(t){return t.map((function(t){return Nu(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Ka.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return zu(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=Va(u);if(a===n.userId&&e.path.isEqual(h))return Gu(t).get(c).next((function(t){if(!t)throw wi();Ei(t.userId===n.userId),o.push(Nu(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Ms(Si),i=[];return e.forEach((function(e){var o=Ka.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=zu(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=Va(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),ou.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ka.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Ms(Si);return zu(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=Va(u);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Gu(t).get(e).next((function(t){if(null===t)throw wi();Ei(t.userId===n.userId),r.push(Nu(n.R,t))})))})),ou.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return qu(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),ou.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Qt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return ou.resolve();var r=IDBKeyRange.lowerBound(Ka.prefixForUser(e.userId)),i=[];return zu(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Va(t[1]);i.push(o)}else r.done()})).next((function(){Ei(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return Ku(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Hu(t).get(this.userId).next((function(t){return t||new Ba(e.userId,-1,"")}))},t}();function Ku(t,e,n){var r=Ka.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return zu(t).$t({range:o,kt:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function Gu(t){return vu(t,ja.store)}function zu(t){return vu(t,Ka.store)}function Hu(t){return vu(t,Ba.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qu=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Wu=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new Qu(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return Ci.fromTimestamp(new Di(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Yu(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return Ei(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Yu(t).$t((function(s,a){var u=Du(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return ou.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Yu(t).$t((function(t,n){var r=Du(n);e(r)}))},t.prototype.Xt=function(t){return Xu(t).get(Xa.key).next((function(t){return Ei(null!==t),t}))},t.prototype.Zt=function(t,e){return Xu(t).put(Xa.key,e)},t.prototype.te=function(t,e){return Yu(t).put(Cu(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=vo(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Yu(t).$t({range:r,index:Wa.queryTargetsIndexName},(function(t,n,r){var o=Du(n);go(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=$u(t);return e.forEach((function(e){var s=Pa(e.path);i.push(o.put(new Ya(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),ou.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=$u(t);return ou.forEach(e,(function(e){var o=Pa(e.path);return ou.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=$u(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=$u(t),i=zs();return r.$t({range:n,kt:!0},(function(t,e,n){var r=Va(t[1]),o=new Yi(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Pa(e.path),r=IDBKeyRange.bound([n],[Ni(n)],!1,!0),i=0;return $u(t).$t({index:Ya.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Yu(t).get(e).next((function(t){return t?Du(t):null}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yu(t){return vu(t,Wa.store)}function Xu(t){return vu(t,Xa.store)}function $u(t){return vu(t,Ya.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ju(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){if(t.code!==fi.FAILED_PRECONDITION||t.message!==nu)throw t;return vi("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zu(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Si(n,i);return 0===s?Si(r,o):s}var tc=function(){function t(t){this.ne=t,this.buffer=new Ms(Zu),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Zu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),ec=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;vi("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return r(e,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return hu(e=n.sent())?(vi("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ju(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),nc=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return ou.resolve(li.o);var r=new tc(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(vi("LruGarbageCollector","Garbage collection skipped; disabled"),ou.resolve(Vu)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(vi("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Vu):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(vi("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),yi()<=N.DEBUG&&vi("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),ou.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),rc=function(){function t(t,e){this.db=t,this.garbageCollector=new nc(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return ic(t,n)},t.prototype.removeReference=function(t,e,n){return ic(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return ic(t,e)},t.prototype._e=function(t,e){return r=e,i=!1,Hu(n=t).Ot((function(t){return Ku(n,t,r).next((function(t){return t&&(i=!0),ou.resolve(!t)}))})).next((function(){return i}));var n,r,i},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),$u(t).delete([0,Pa(s.path)])}))}));i.push(u)}})).next((function(){return ou.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return ic(t,e)},t.prototype.we=function(t,e){var n,r=$u(t),i=li.o;return r.$t({index:Ya.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),a=r.sequenceNumber;0===o?(i!==li.o&&e(new Yi(Va(n)),i),i=a,n=s):i=li.o})).next((function(){i!==li.o&&e(new Yi(Va(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function ic(t,e){return $u(t).put((n=e,r=t.currentSequenceNumber,new Ya(0,Pa(n.path),r)));var n,r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oc=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Ri(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return xi(this.inner)},t}(),sc=function(){function t(){this.changes=new oc((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:Ci.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:fo.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?ou.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),ac=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return hc(t).put(lc(e),n)},t.prototype.removeEntry=function(t,e){var n=hc(t),r=lc(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return hc(t).get(lc(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return hc(t).get(lc(e)).next((function(t){return{document:n.ye(e,t),size:Bu(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=qs();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=qs(),i=new Ls(Yi.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Bu(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return ou.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return hc(t).$t({range:r},(function(t,e,r){for(var s=Yi.fromSegments(t);o&&Yi.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=qs(),o=e.path.length+1,s={};if(n.isEqual(Ci.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=Tu(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Ha.collectionReadTimeIndex}return hc(t).$t(s,(function(t,n,s){if(t.length===o){var a=Eu(r.R,n);e.path.isPrefixOf(a.key.path)?Wo(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new uc(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return cc(t).get(Qa.key).next((function(t){return Ei(!!t),t}))},t.prototype.me=function(t,e){return cc(t).put(Qa.key,e)},t.prototype.ye=function(t,e){if(e){var n=Eu(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(Ci.min()))return n}return fo.newInvalidDocument(t)},t}(),uc=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new oc((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return e(n,t),n.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Ms((function(t,e){return Si(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=Iu(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Bu(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=Iu(e.Ie.R,fo.newNoDocument(o,Ci.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),ou.waitFor(n)},n.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},n.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},n}(sc);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cc(t){return vu(t,Qa.store)}function hc(t){return vu(t,Ha.store)}function lc(t){return t.path.toArray()}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fc=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Ei(n<r&&n>=0&&r<=11);var o=new su("createOrUpgrade",e);n<1&&r>=1&&(t.createObjectStore(qa.store),function(t){t.createObjectStore(Ba.store,{keyPath:Ba.keyPath}),t.createObjectStore(ja.store,{keyPath:ja.keyPath,autoIncrement:!0}).createIndex(ja.userMutationsIndex,ja.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ka.store)}(t),pc(t),function(t){t.createObjectStore(Ha.store)}(t));var s=ou.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ya.store),t.deleteObjectStore(Wa.store),t.deleteObjectStore(Xa.store)}(t),pc(t)),s=s.next((function(){return function(t){var e=t.store(Xa.store),n=new Xa(0,0,Ci.min().toTimestamp(),0);return e.put(Xa.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(ja.store).Nt().next((function(n){t.deleteObjectStore(ja.store),t.createObjectStore(ja.store,{keyPath:ja.keyPath,autoIncrement:!0}).createIndex(ja.userMutationsIndex,ja.userMutationsKeyPath,{unique:!0});var r=e.store(ja.store),i=n.map((function(t){return r.put(t)}));return ou.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Ja.store,{keyPath:Ja.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Qa.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ha.store);e.createIndex(Ha.readTimeIndex,Ha.readTimeIndexPath,{unique:!1}),e.createIndex(Ha.collectionReadTimeIndex,Ha.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Za.store,{keyPath:Za.keyPath})}(t),function(t){t.createObjectStore(tu.store,{keyPath:tu.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(Ha.store).$t((function(t,n){e+=Bu(n)})).next((function(){var n=new Qa(e);return t.store(Qa.store).put(Qa.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Ba.store),r=t.store(ja.store);return n.Nt().next((function(n){return ou.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(ja.userMutationsIndex,i).next((function(r){return ou.forEach(r,(function(r){Ei(r.userId===n.userId);var i=Nu(e.R,r);return qu(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Ya.store),n=t.store(Ha.store);return t.store(Xa.store).get(Xa.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new Li(n),s=[0,Pa(o)];r.push(e.get(s).next((function(n){return n?ou.resolve():(r=o,e.put(new Ya(0,Pa(r),t.highestListenSequenceNumber)));var r})))})).next((function(){return ou.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore($a.store,{keyPath:$a.keyPath});var n=e.store($a.store),r=new Pu,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Pa(i)})}};return e.store(Ha.store).$t({kt:!0},(function(t,e){var n=new Li(t);return i(n.popLast())})).next((function(){return e.store(Ka.store).$t({kt:!0},(function(t,e){t[0];var n=t[1],r=(t[2],Va(n));return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Wa.store);return n.$t((function(t,r){var i=Du(r),o=Cu(e.R,i);return n.put(o)}))},t}();function pc(t){t.createObjectStore(Ya.store,{keyPath:Ya.keyPath}).createIndex(Ya.documentTargetsIndex,Ya.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Wa.store,{keyPath:Wa.keyPath}).createIndex(Wa.queryTargetsIndexName,Wa.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Xa.store)}var dc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",yc=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new pi(fi.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");var l,f;this.referenceDelegate=new rc(this,i),this.Le=n+"main",this.R=new wu(u),this.Be=new au(this.Le,11,new fc(this.R)),this.qe=new Wu(this.referenceDelegate,this.R),this.Ut=new Fu,this.Ue=(l=this.R,f=this.Ut,new ac(l,f)),this.Qe=new Ru,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===h&&gi("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new pi(fi.FAILED_PRECONDITION,dc);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new li(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return r(e,void 0,void 0,(function(){return i(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return r(e,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return gc(e).put(new Ja(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(hu(e))return vi("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return vi("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return vc(t).get(qa.key).next((function(t){return ou.resolve(e.tn(t))}))},t.prototype.en=function(t){return gc(t).delete(this.clientId)},t.prototype.nn=function(){return r(this,void 0,void 0,(function(){var t,e,n,r,o=this;return i(this,(function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=vu(t,Ja.store);return e.Nt().next((function(t){var n=o.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return ou.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=i.sent(),this.Ke)for(e=0,n=t;e<n.length;e++)r=n[e],this.Ke.removeItem(this.on(r.clientId));i.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?ou.resolve(!0):vc(t).get(qa.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new pi(fi.FAILED_PRECONDITION,dc);return!1}}return!(!e.networkEnabled||!e.inForeground)||gc(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&vi("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[qa.store,Ja.store],(function(e){var n=new yu(e,li.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return gc(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return ju.Kt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;vi("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,eu,(function(o){return i=new yu(o,r.Ne?r.Ne.next():li.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw gi("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new pi(fi.FAILED_PRECONDITION,nu);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return vc(t).get(qa.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new pi(fi.FAILED_PRECONDITION,dc)}))},t.prototype.Ze=function(t){var e=new qa(this.clientId,this.allowTabSynchronization,Date.now());return vc(t).put(qa.key,e)},t.yt=function(){return au.yt()},t.prototype.Xe=function(t){var e=this,n=vc(t);return n.get(qa.key).next((function(t){return e.tn(t)?(vi("IndexedDbPersistence","Releasing primary lease."),n.delete(qa.key)):ou.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(gi("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Ke)||void 0===e?void 0:e.getItem(this.on(t)));return vi("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(r){return gi("IndexedDbPersistence","Failed to get zombied client id.",r),!1}},t.prototype.un=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(t){gi("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function vc(t){return vu(t,qa.store)}function gc(t){return vu(t,Ja.store)}function mc(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var bc=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return r=e,Yi.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Tn(t,e.path):Bo(e)?this.In(t,e,n):this.An(t,e,n);var r},t.prototype.Tn=function(t,e){return this.mn(t,new Yi(e)).next((function(t){var e=js();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=js();return this.Ut.getCollectionParents(t,i).next((function(s){return ou.forEach(s,(function(s){var a,u,c=(a=e,u=s.child(i),new Lo(u,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt));return r.An(t,c,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=fo.newInvalidDocument(c),r=r.insert(c,h)),ms(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){Wo(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=zs(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Ts&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),wc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=zs(),i=zs(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Ec=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i,o=this;return 0===(i=e).filters.length&&null===i.limit&&null==i.startAt&&null==i.endAt&&(0===i.explicitOrderBy.length||1===i.explicitOrderBy.length&&i.explicitOrderBy[0].field.isKeyField())||n.isEqual(Ci.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(i){var s=o.Cn(e,i);return(Mo(e)||Vo(e))&&o.Nn(e.limitType,s,r,n)?o.Dn(t,e):(yi()<=N.DEBUG&&vi("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Qo(e)),o.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Ms(Yo(t));return e.forEach((function(e,r){Wo(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return yi()<=N.DEBUG&&vi("QueryEngine","Using full collection scan to execute query:",Qo(e)),this.Sn.getDocumentsMatchingQuery(t,e,Ci.min())},t}(),Ic=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new Ls(Si),this.kn=new oc((function(t){return vo(t)}),go),this.$n=Ci.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new bc(this.On,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tc(t,e,n,r){return new Ic(t,e,n,r)}function _c(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s;return i(this,(function(i){switch(i.label){case 0:return n=Ii(t),r=n._n,o=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var i;return n._n.getAllMutationBatches(t).next((function(s){return i=s,r=n.persistence.getMutationQueue(e),o=new bc(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=zs(),a=0,u=i;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var v=0,g=y.mutations;v<g.length;v++){var m=g[v];s=s.add(m.key)}}return o.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return s=i.sent(),[2,(n._n=r,n.Mn=o,n.xn.Vn(n.Mn),s)]}}))}))}function Sc(t,e){var n=Ii(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r,i,o,s,a,u,c,h=e.batch.keys(),l=n.On.newChangeBuffer({trackRemovals:!0});return(r=n,i=t,o=e,s=l,a=o.batch,u=a.keys(),c=ou.resolve(),u.forEach((function(t){c=c.next((function(){return s.getEntry(i,t)})).next((function(e){var n=o.docVersions.get(t);Ei(null!==n),e.version.compareTo(n)<0&&(a.applyToRemoteDocument(e,o),e.isValidDocument()&&s.addEntry(e,o.commitVersion))}))})),c.next((function(){return r._n.removeMutationBatch(i,a)}))).next((function(){return l.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,h)}))}))}function Ac(t){var e=Ii(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function Nc(t,e){var n=Ii(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach((function(e,o){var a,u,c,h=i.get(o);if(h){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var l=e.resumeToken;if(l.approximateByteSize()>0){var f=h.withResumeToken(l,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,f),a=h,c=e,Ei((u=f).resumeToken.approximateByteSize()>0),(0===a.resumeToken.approximateByteSize()||u.snapshotVersion.toMicroseconds()-a.snapshotVersion.toMicroseconds()>=3e8||c.addedDocuments.size+c.modifiedDocuments.size+c.removedDocuments.size>0)&&s.push(n.qe.updateTargetData(t,f))}}}));var a=qs();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(function(t,e,n,r,i){var o=zs();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=qs();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(Ci.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):vi("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(Ci.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return ou.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.Fn=i,t}))}function Dc(t,e){var n=Ii(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function Cc(t,e){var n=Ii(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,ou.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new bu(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function kc(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,a;return i(this,(function(i){switch(i.label){case 0:r=Ii(t),o=r.Fn.get(e),s=n?"readwrite":"readwrite-primary",i.label=1;case 1:return i.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",s,(function(t){return r.persistence.referenceDelegate.removeTarget(t,o)}))];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:if(!hu(a=i.sent()))throw a;return vi("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(o.target),[2]}}))}))}function Rc(t,e,n){var r=Ii(t),i=Ci.min(),o=zs();return r.persistence.runTransaction("Execute query","readonly",(function(t){return(s=r,a=t,u=Ko(e),c=Ii(s),h=c.kn.get(u),void 0!==h?ou.resolve(c.Fn.get(h)):c.qe.getTargetData(a,u)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:Ci.min(),n?o:zs())})).next((function(t){return{documents:t,Bn:o}}));var s,a,u,c,h}))}function xc(t,e){var n=Ii(t),r=Ii(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Oc(t){var e=Ii(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return n=e.On,r=t,i=e.$n,o=Ii(n),s=qs(),a=Tu(i),u=hc(r),c=IDBKeyRange.lowerBound(a,!0),u.$t({index:Ha.readTimeIndex,range:c},(function(t,e){var n=Eu(o.R,e);s=s.insert(n.key,n),a=e.readTime})).next((function(){return{wn:s,readTime:_u(a)}}));var n,r,i,o,s,a,u,c})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function Lc(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){return[2,(e=Ii(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return e=hc(t),n=Ci.min(),e.$t({index:Ha.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=_u(e.readTime)),r.done()})).next((function(){return n}));var e,n})).then((function(t){e.$n=t}))]}))}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pc=function(){function t(t){this.R=t,this.Kn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return ou.resolve(this.Kn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Kn.set(e.id,{id:(n=e).id,version:n.version,createTime:ca(n.createTime)}),ou.resolve()},t.prototype.getNamedQuery=function(t,e){return ou.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,{name:(n=e).name,query:ku(n.bundledQuery),readTime:ca(n.readTime)}),ou.resolve();var n},t}(),Fc=function(){function t(){this.Wn=new Ms(Mc.Gn),this.zn=new Ms(Mc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Mc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new Mc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new Yi(new Li([])),r=new Mc(n,t),i=new Mc(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Yi(new Li([])),n=new Mc(e,t),r=new Mc(e,t+1),i=zs();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Mc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Mc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Yi.comparator(t.key,e.key)||Si(t.ns,e.ns)},t.Hn=function(t,e){return Si(t.ns,e.ns)||Yi.comparator(t.key,e.key)},t}(),Vc=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Ms(Mc.Gn)}return t.prototype.checkEmpty=function(t){return ou.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new gu(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new Mc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return ou.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return ou.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return ou.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return ou.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return ou.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Mc(e,0),i=new Mc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),ou.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Ms(Si);return e.forEach((function(t){var e=new Mc(t,0),i=new Mc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),ou.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Yi.isDocumentKey(i)||(i=i.child(""));var o=new Mc(new Yi(i),0),s=new Ms(Si);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),ou.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Ei(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return ou.forEach(e.mutations,(function(i){var o=new Mc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Mc(e,0),r=this.rs.firstAfterOrEqual(n);return ou.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,ou.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),Uc=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new Ls(Yi.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return ou.resolve(n?n.document.clone():fo.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=qs();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():fo.newInvalidDocument(t))})),ou.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=qs(),i=new Yi(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(a.path))break;h.compareTo(n)<=0||Wo(e,c)&&(r=r.insert(c.key,c.clone()))}return ou.resolve(r)},t.prototype.fs=function(t,e){return ou.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new qc(this)},t.prototype.getSize=function(t){return ou.resolve(this.size)},t}(),qc=function(t){function n(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return e(n,t),n.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),ou.waitFor(n)},n.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},n.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},n}(sc),Bc=function(){function t(t){this.persistence=t,this.ds=new oc((function(t){return vo(t)}),go),this.lastRemoteSnapshotVersion=Ci.min(),this.highestTargetId=0,this.ws=0,this._s=new Fc,this.targetCount=0,this.ys=Qu.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),ou.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return ou.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return ou.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),ou.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),ou.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Qu(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,ou.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),ou.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,ou.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),ou.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return ou.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return ou.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),ou.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),ou.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),ou.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return ou.resolve(n)},t.prototype.containsKey=function(t,e){return ou.resolve(this._s.containsKey(e))},t}(),jc=function(){function t(t,e){var n,r=this;this.gs={},this.Ne=new li(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Bc(this),this.Ut=new Lu,this.Ue=(n=this.Ut,new Uc(n,(function(t){return r.referenceDelegate.ps(t)}))),this.R=new wu(e),this.Qe=new Pc(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Vc(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;vi("MemoryPersistence","Starting transaction:",t);var i=new Kc(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return ou.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),Kc=function(t){function n(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return e(n,t),n}(ru),Gc=function(){function t(t){this.persistence=t,this.As=new Fc,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw wi()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),ou.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),ou.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),ou.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ou.forEach(this.vs,(function(r){var i=Yi.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return ou.or([function(){return ou.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),zc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hc(t,e){return"firestore_clients_"+t+"_"+e}function Qc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Wc(t,e){return"firestore_targets_"+t+"_"+e}zc.UNAUTHENTICATED=new zc(null),zc.GOOGLE_CREDENTIALS=new zc("google-credentials-uid"),zc.FIRST_PARTY=new zc("first-party-uid");var Yc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new pi(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(gi("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Xc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new pi(i.error.code,i.error.message)),o?new t(e,i.state,r):(gi("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),$c=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Qs(),s=0;i&&s<r.activeTargetIds.length;++s)i=Wi(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(gi("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Jc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(gi("SharedClientState","Failed to parse online state: "+e),null)},t}(),Zc=function(){function t(){this.activeTargetIds=Qs()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),th=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new Ls(Si),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Hc(this.persistenceKey,this.Ns),this.Ms="firestore_sequence_number_"+this.persistenceKey,this.ks=this.ks.insert(this.Ns,new Zc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Qs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return r(this,void 0,void 0,(function(){var t,e,n,r,o,s,a,u,c,h,l,f=this;return i(this,(function(i){switch(i.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=i.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(o=this.getItem(Hc(this.persistenceKey,r)))&&(s=$c.Vs(r,o))&&(this.ks=this.ks.insert(s.clientId,s));for(this.Ks(),(a=this.storage.getItem(this.Us))&&(u=this.js(a))&&this.Ws(u),c=0,h=this.$s;c<h.length;c++)l=h[c],this.Fs(l);return this.$s=[],this.window.addEventListener("pagehide",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Wc(this.persistenceKey,t));if(n){var r=Xc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Ks(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Ks()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Wc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return vi("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){vi("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){vi("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(vi("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void gi("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return r(e,void 0,void 0,(function(){var t,e,r,o,s,a;return i(this,(function(i){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(o=this.ri(n.key,n.newValue)))return[2,this.oi(o)]}else if(n.key===this.Us){if(null!==n.newValue&&(s=this.js(n.newValue)))return[2,this.Ws(s)]}else if(n.key===this.Ms)(a=function(t){var e=li.o;if(null!=t)try{var n=JSON.parse(t);Ei("number"==typeof n),e=n}catch(r){gi("SharedClientState","Failed to read sequence number from WebStorage",r)}return e}(n.newValue))!==li.o&&this.sequenceNumberHandler(a);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Ks=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Yc(this.currentUser,t,e,n),i=Qc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Qc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=Wc(this.persistenceKey,t),i=new Xc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return $c.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Yc.Vs(new zc(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Xc.Vs(r,e)},t.prototype.js=function(t){return Jc.Vs(t)},t.prototype.ii=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(vi("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Qs();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),eh=function(){function t(){this.li=new Zc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Zc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),nh=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),rh=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){vi("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){vi("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),ih={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},oh=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),sh=function(t){function n(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return e(n,t),n.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var s=new hi;s.listenOnce(ii.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case ri.NO_ERROR:var e=s.getResponseJson();vi("Connection","XHR received:",JSON.stringify(e)),i(e);break;case ri.TIMEOUT:vi("Connection",'RPC "'+t+'" timed out'),o(new pi(fi.DEADLINE_EXCEEDED,"Request time out"));break;case ri.HTTP_ERROR:var n=s.getStatus();if(vi("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(fi).indexOf(c)>=0?c:fi.UNKNOWN);o(new pi(a,r.message))}else o(new pi(fi.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new pi(fi.UNAVAILABLE,"Connection failed."));break;default:wi()}}finally{vi("Connection",'RPC "'+t+'" completed.')}var u,c}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},n.prototype.Oi=function(t,e){var n,r,i=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=new Hr,s=Qe(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new ui({})),this.Fi(a.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())||"object"==typeof navigator&&"ReactNative"===navigator.product||l().indexOf("Electron/")>=0||((r=l()).indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0)||l().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(a.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");vi("Connection","Creating WebChannel: "+u,a);var c=o.createWebChannel(u,a),h=!1,f=!1,p=new oh({Ei:function(t){f?vi("Connection","Not sending because WebChannel is closed:",t):(h||(vi("Connection","Opening WebChannel transport."),c.open(),h=!0),vi("Connection","WebChannel sending:",t),c.send(t))},Ti:function(){return c.close()}}),d=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(e){setTimeout((function(){throw e}),0)}}))};return d(c,ci.EventType.OPEN,(function(){f||vi("Connection","WebChannel transport opened.")})),d(c,ci.EventType.CLOSE,(function(){f||(f=!0,vi("Connection","WebChannel transport closed"),p.Vi())})),d(c,ci.EventType.ERROR,(function(t){f||(f=!0,mi("Connection","WebChannel transport errored:",t),p.Vi(new pi(fi.UNAVAILABLE,"The operation could not be completed")))})),d(c,ci.EventType.MESSAGE,(function(t){var e;if(!f){var n=t.data[0];Ei(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){vi("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=Ns[t];if(void 0!==e)return Os(e)}(o),a=i.message;void 0===s&&(s=fi.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),f=!0,p.Vi(new pi(s,a)),c.close()}else vi("Connection","WebChannel received:",n),p.Si(n)}})),d(s,oi.STAT_EVENT,(function(t){t.stat===si?vi("Connection","Detected buffering proxy"):t.stat===ai&&vi("Connection","Detected no buffering proxy")})),setTimeout((function(){p.Pi()}),0),p},n}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);vi("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return vi("RestConnection","Received: ",t),t}),(function(e){throw mi("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.6.7",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=ih[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ah(){return"undefined"!=typeof window?window:null}function uh(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ch(t){return new oa(t,!0)}var hh=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Ki=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&vi("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Qi=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),lh=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new hh(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===fi.RESOURCE_EXHAUSTED?(gi(e.toString()),gi("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):e&&e.code===fi.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new pi(fi.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return r(t,void 0,void 0,(function(){return i(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return vi("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(vi("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),fh=function(t){function n(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return e(n,t),n.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},n.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n,r;if("targetChange"in e){e.targetChange;var i="NO_CHANGE"===(r=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:wi(),o=e.targetChange.targetIds||[],s=function(t,e){return t.I?(Ei(void 0===e||"string"==typeof e),Vi.fromBase64String(e||"")):(Ei(void 0===e||e instanceof Uint8Array),Vi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?fi.UNKNOWN:Os(t.code);return new pi(e,t.message||"")}(u);n=new Js(i,o,s,a||null)}else if("documentChange"in e){e.documentChange,(i=e.documentChange).document,i.document.name,i.document.updateTime,o=pa(t,i.document.name),s=ca(i.document.updateTime);var u=new ho({mapValue:{fields:i.document.fields}}),c=(a=fo.newFoundDocument(o,s,u),i.targetIds||[]),h=i.removedTargetIds||[];n=new Xs(c,h,a.key,a)}else if("documentDelete"in e)e.documentDelete,(i=e.documentDelete).document,o=pa(t,i.document),s=i.readTime?ca(i.readTime):Ci.min(),u=fo.newNoDocument(o,s),a=i.removedTargetIds||[],n=new Xs([],a,u.key,u);else if("documentRemove"in e)e.documentRemove,(i=e.documentRemove).document,o=pa(t,i.document),s=i.removedTargetIds||[],n=new Xs([],s,o,null);else{if(!("filter"in e))return wi();e.filter;var l=e.filter;l.targetId,i=l.count||0,o=new Rs(i),s=l.targetId,n=new $s(s,o)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return Ci.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Ci.min():e.readTime?ca(e.readTime):Ci.min()}(t);return this.listener._r(e,n)},n.prototype.mr=function(t){var e,n,r,i,o={};o.database=va(this.R),o.addTarget=(e=this.R,i=(n=t).target,(r=mo(i)?{documents:Ea(e,i)}:{query:Ia(e,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=aa(e,n.resumeToken):n.snapshotVersion.compareTo(Ci.min())>0&&(r.readTime=sa(e,n.snapshotVersion.toTimestamp())),r);var s=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return wi()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);s&&(o.labels=s),this.cr(o)},n.prototype.yr=function(t){var e={};e.database=va(this.R),e.removeTarget=t,this.cr(e)},n}(lh),ph=function(t){function n(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return e(n,t),Object.defineProperty(n.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),n.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},n.prototype.ar=function(){this.gr&&this.Er([])},n.prototype.wr=function(t){return this.Hi.Oi("Write",t)},n.prototype.onMessage=function(t){if(Ei(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=(r=t.writeResults,i=t.commitTime,r&&r.length>0?(Ei(void 0!==i),r.map((function(t){return n=i,(r=(e=t).updateTime?ca(e.updateTime):ca(n)).isEqual(Ci.min())&&(r=ca(n)),new ps(r,e.transformResults||[]);var e,n,r}))):[]),n=ca(t.commitTime);return this.listener.Tr(n,e)}var r,i;return Ei(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},n.prototype.Ar=function(){var t={};t.database=va(this.R),this.cr(t)},n.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return ba(e.R,t)}))};this.cr(n)},n}(lh),dh=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return e(n,t),n.prototype.br=function(){if(this.Rr)throw new pi(fi.FAILED_PRECONDITION,"The client has already been terminated.")},n.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===fi.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new pi(fi.UNKNOWN,t.toString())}))},n.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===fi.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new pi(fi.UNKNOWN,t.toString())}))},n.prototype.terminate=function(){this.Rr=!0},n}((function(){})),yh=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(gi(e),this.Vr=!1):vi("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),vh=function(t,e,n,o,s){var a=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=s,this.Lr.di((function(t){n.enqueueAndForget((function(){return r(a,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return Sh(this)?(vi("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return(e=Ii(t)).Or.add(4),[4,mh(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,gh(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new yh(n,o)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gh(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:if(!Sh(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function mh(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function bh(t,e){var n=Ii(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),_h(n)?Th(n):qh(n).er()&&Eh(n,e))}function wh(t,e){var n=Ii(t),r=qh(n);n.$r.delete(e),r.er()&&Ih(n,e),0===n.$r.size&&(r.er()?r.ir():Sh(n)&&n.Br.set("Unknown"))}function Eh(t,e){t.qr.U(e.targetId),qh(t).mr(e)}function Ih(t,e){t.qr.U(e),qh(t).yr(e)}function Th(t){t.qr=new ta({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),qh(t).start(),t.Br.Sr()}function _h(t){return Sh(t)&&!qh(t).tr()&&t.$r.size>0}function Sh(t){return 0===Ii(t).Or.size}function Ah(t){t.qr=void 0}function Nh(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return t.$r.forEach((function(e,n){Eh(t,e)})),[2]}))}))}function Dh(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){return Ah(t),_h(t)?(t.Br.Nr(e),Th(t)):t.Br.set("Unknown"),[2]}))}))}function Ch(t,e,n){return r(this,void 0,void 0,(function(){var o,s,a;return i(this,(function(u){switch(u.label){case 0:if(t.Br.set("Online"),!(e instanceof Js&&2===e.state&&e.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s;return i(this,(function(i){switch(i.label){case 0:n=e.cause,r=0,o=e.targetIds,i.label=1;case 1:return r<o.length?(s=o[r],t.$r.has(s)?[4,t.remoteSyncer.rejectListen(s,n)]:[3,3]):[3,5];case 2:i.sent(),t.$r.delete(s),t.qr.removeTarget(s),i.label=3;case 3:i.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return u.sent(),[3,5];case 3:return o=u.sent(),vi("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),o),[4,kh(t,o)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Xs?t.qr.X(e):e instanceof $s?t.qr.rt(e):t.qr.et(e),n.isEqual(Ci.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,Ac(t.localStore)];case 8:return s=u.sent(),n.compareTo(s)>=0?[4,(c=t,h=n,l=c.qr.ut(h),l.targetChanges.forEach((function(t,e){if(t.resumeToken.approximateByteSize()>0){var n=c.$r.get(e);n&&c.$r.set(e,n.withResumeToken(t.resumeToken,h))}})),l.targetMismatches.forEach((function(t){var e=c.$r.get(t);if(e){c.$r.set(t,e.withResumeToken(Vi.EMPTY_BYTE_STRING,e.snapshotVersion)),Ih(c,t);var n=new bu(e.target,t,1,e.sequenceNumber);Eh(c,n)}})),c.remoteSyncer.applyRemoteEvent(l))]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return vi("RemoteStore","Failed to raise snapshot:",a=u.sent()),[4,kh(t,a)];case 12:return u.sent(),[3,13];case 13:return[2]}var c,h,l}))}))}function kh(t,e,n){return r(this,void 0,void 0,(function(){var o=this;return i(this,(function(s){switch(s.label){case 0:if(!hu(e))throw e;return t.Or.add(1),[4,mh(t)];case 1:return s.sent(),t.Br.set("Offline"),n||(n=function(){return Ac(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return r(o,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return vi("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,gh(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Rh(t,e){return e().catch((function(n){return kh(t,n,e)}))}function xh(t){return r(this,void 0,void 0,(function(){var e,n,r,o,s;return i(this,(function(i){switch(i.label){case 0:e=Ii(t),n=Bh(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,i.label=1;case 1:if(!(Sh(a=e)&&a.kr.length<10))return[3,7];i.label=2;case 2:return i.trys.push([2,4,,6]),[4,Dc(e.localStore,r)];case 3:return null===(o=i.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=o.batchId,function(t,e){t.kr.push(e);var n=Bh(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,o),[3,6]);case 4:return s=i.sent(),[4,kh(e,s)];case 5:return i.sent(),[3,6];case 6:return[3,1];case 7:return Oh(e)&&Lh(e),[2]}var a}))}))}function Oh(t){return Sh(t)&&!Bh(t).tr()&&t.kr.length>0}function Lh(t){Bh(t).start()}function Ph(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return Bh(t).Ar(),[2]}))}))}function Fh(t){return r(this,void 0,void 0,(function(){var e,n,r,o;return i(this,(function(i){for(e=Bh(t),n=0,r=t.kr;n<r.length;n++)o=r[n],e.Er(o.mutations);return[2]}))}))}function Mh(t,e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return r=t.kr.shift(),o=mu.from(r,e,n),[4,Rh(t,(function(){return t.remoteSyncer.applySuccessfulWrite(o)}))];case 1:return i.sent(),[4,xh(t)];case 2:return i.sent(),[2]}}))}))}function Vh(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return e&&Bh(t).pr?[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return xs(r=e.code)&&r!==fi.ABORTED?(n=t.kr.shift(),Bh(t).sr(),[4,Rh(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,xh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Oh(t)&&Lh(t),[2]}}))}))}function Uh(t,e){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return n=Ii(t),e?(n.Or.delete(2),[4,gh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,mh(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function qh(t){var e,n,o,s,a=this;return t.Ur||(t.Ur=(e=t.datastore,n=t.asyncQueue,o={Ii:Nh.bind(null,t),Ri:Dh.bind(null,t),_r:Ch.bind(null,t)},(s=Ii(e)).br(),new fh(n,s.Hi,s.credentials,s.R,o)),t.Mr.push((function(e){return r(a,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return e?(t.Ur.sr(),_h(t)?Th(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:n.sent(),Ah(t),n.label=3;case 3:return[2]}}))}))}))),t.Ur}function Bh(t){var e,n,o,s,a=this;return t.Qr||(t.Qr=(e=t.datastore,n=t.asyncQueue,o={Ii:Ph.bind(null,t),Ri:Vh.bind(null,t),Ir:Fh.bind(null,t),Tr:Mh.bind(null,t)},(s=Ii(e)).br(),new ph(n,s.Hi,s.credentials,s.R,o)),t.Mr.push((function(e){return r(a,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return e?(t.Qr.sr(),[4,xh(t)]):[3,2];case 1:return n.sent(),[3,4];case 2:return[4,t.Qr.stop()];case 3:n.sent(),t.kr.length>0&&(vi("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),n.label=4;case 4:return[2]}}))}))}))),t.Qr}var jh=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new iu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new pi(fi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Kh(t,e){if(gi("AsyncQueue",e+": "+t),hu(t))return new pi(fi.UNAVAILABLE,e+": "+t);throw t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gh=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Yi.comparator(e.key,n.key)}:function(t,e){return Yi.comparator(t.key,e.key)},this.keyedMap=js(),this.sortedSet=new Ls(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),zh=function(){function t(){this.Kr=new Ls(Yi.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);n?0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):wi():this.Kr=this.Kr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Kr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Hh=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Gh.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&zo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Qh=function(){this.Wr=void 0,this.listeners=[]},Wh=function(){this.queries=new oc((function(t){return Ho(t)}),zo),this.onlineState="Unknown",this.Gr=new Set};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yh(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a,u,c;return i(this,(function(i){switch(i.label){case 0:if(n=Ii(t),r=e.query,o=!1,(s=n.queries.get(r))||(o=!0,s=new Qh),!o)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),a=s,[4,n.onListen(r)];case 2:return a.Wr=i.sent(),[3,4];case 3:return u=i.sent(),c=Kh(u,"Initialization of query '"+Qo(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.queries.set(r,s),s.listeners.push(e),e.zr(n.onlineState),s.Wr&&e.Hr(s.Wr)&&Zh(n),[2]}}))}))}function Xh(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a;return i(this,(function(i){return n=Ii(t),r=e.query,o=!1,(s=n.queries.get(r))&&(a=s.listeners.indexOf(e))>=0&&(s.listeners.splice(a,1),o=0===s.listeners.length),o?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function $h(t,e){for(var n=Ii(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(s)&&(r=!0);u.Wr=s}}r&&Zh(n)}function Jh(t,e,n){var r=Ii(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Zh(t){t.Gr.forEach((function(t){t.next()}))}var tl=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Hh(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Hh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),el=function(t){this.key=t},nl=function(t){this.key=t},rl=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=zs(),this.mutatedKeys=zs(),this.lo=Yo(t),this.fo=new Gh(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new zh,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=Mo(this.query)&&i.size===this.query.limit?i.last():null,c=Vo(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=Wo(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data.isEqual(l.data)?f!==p&&(r.track({type:3,doc:l}),d=!0):n.yo(h,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Mo(this.query)||Vo(this.query))for(;s.size>this.query.limit;){var h=Mo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return n=t.type,i=e.type,(o=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wi()}})(n)-o(i)||r.lo(t.doc,e.doc);var n,i,o})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Hh(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new zh,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=zs(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new nl(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new el(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=zs();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Hh.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),il=function(t,e,n){this.query=t,this.targetId=e,this.view=n},ol=function(t){this.key=t,this.bo=!1},sl=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new oc((function(t){return Ho(t)}),zo),this.Vo=new Map,this.So=new Set,this.Do=new Ls(Yi.comparator),this.Co=new Map,this.No=new Fc,this.xo={},this.Fo=new Map,this.ko=Qu.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a,u;return i(this,(function(i){switch(i.label){case 0:return n=Fl(t),(s=n.Po.get(e))?(r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),o=s.view.Ro(),[3,4]):[3,1];case 1:return[4,Cc(n.localStore,Ko(e))];case 2:return a=i.sent(),u=n.sharedClientState.addLocalQueryTarget(a.targetId),r=a.targetId,[4,ul(n,e,r,"current"===u)];case 3:o=i.sent(),n.isPrimaryClient&&bh(n.remoteStore,a),i.label=4;case 4:return[2,o]}}))}))}function ul(t,e,n,o){return r(this,void 0,void 0,(function(){var s,a,u,c,h,l;return i(this,(function(f){switch(f.label){case 0:return t.Oo=function(e,n,o){return function(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s,a;return i(this,(function(i){switch(i.label){case 0:return(r=e.view._o(n)).Nn?[4,Rc(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,r)}))]:[3,2];case 1:r=i.sent(),i.label=2;case 2:return s=o&&o.targetChanges.get(e.targetId),a=e.view.applyChanges(r,t.isPrimaryClient,s),[2,(El(t,e.targetId,a.To),a.snapshot)]}}))}))}(t,e,n,o)},[4,Rc(t.localStore,e,!0)];case 1:return s=f.sent(),a=new rl(e,s.Bn),u=a._o(s.documents),c=Ys.createSynthesizedTargetChangeForCurrentChange(n,o&&"Offline"!==t.onlineState),h=a.applyChanges(u,t.isPrimaryClient,c),El(t,n,h.To),l=new il(e,n,a),[2,(t.Po.set(e,l),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),h.snapshot)]}}))}))}function cl(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=Ii(t),r=n.Po.get(e),(o=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,o.filter((function(t){return!zo(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,kc(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),wh(n.remoteStore,r.targetId),bl(n,r.targetId)})).catch(Ju)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return bl(n,r.targetId),[4,kc(n.localStore,r.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))}function hl(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,a;return i(this,(function(i){switch(i.label){case 0:r=Ml(t),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,(u=r.localStore,c=e,l=Ii(u),f=Di.now(),p=c.reduce((function(t,e){return t.add(e.key)}),zs()),l.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return l.Mn.pn(t,p).next((function(e){h=e;for(var n=[],r=0,i=c;r<i.length;r++){var o=i[r],s=bs(o,h.get(o.key));null!=s&&n.push(new Ts(o.key,s,lo(s.value.mapValue),ds.exists(!0)))}return l._n.addMutationBatch(t,f,n,c)}))})).then((function(t){return t.applyToLocalDocumentSet(h),{batchId:t.batchId,changes:h}})))];case 2:return o=i.sent(),r.sharedClientState.addPendingMutation(o.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new Ls(Si)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,o.batchId,n),[4,_l(r,o.changes)];case 3:return i.sent(),[4,xh(r.remoteStore)];case 4:return i.sent(),[3,6];case 5:return s=i.sent(),a=Kh(s,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}var u,c,h,l,f,p}))}))}function ll(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:n=Ii(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Nc(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(Ei(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Ei(r.bo):t.removedDocuments.size>0&&(Ei(r.bo),r.bo=!1))})),[4,_l(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Ju(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function fl(t,e,n){var r=Ii(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Ii(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&Zh(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function pl(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,a,u,c;return i(this,(function(i){switch(i.label){case 0:return(r=Ii(t)).sharedClientState.updateQueryState(e,"rejected",n),o=r.Co.get(e),(s=o&&o.key)?(a=(a=new Ls(Yi.comparator)).insert(s,fo.newNoDocument(s,Ci.min())),u=zs().add(s),c=new Ws(Ci.min(),new Map,new Ms(Si),a,u),[4,ll(r,c)]):[3,2];case 1:return i.sent(),r.Do=r.Do.remove(s),r.Co.delete(e),Tl(r),[3,4];case 2:return[4,kc(r.localStore,e,!1).then((function(){return bl(r,e,n)})).catch(Ju)];case 3:i.sent(),i.label=4;case 4:return[2]}}))}))}function dl(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:n=Ii(t),r=e.batch.batchId,i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Sc(n.localStore,e)];case 2:return o=i.sent(),ml(n,r,null),gl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,_l(n,o)];case 3:return i.sent(),[3,6];case 4:return[4,Ju(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function yl(t,e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:r=Ii(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,(s=r.localStore,a=e,u=Ii(s),u.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var e;return u._n.lookupMutationBatch(t,a).next((function(n){return Ei(null!==n),e=n.keys(),u._n.removeMutationBatch(t,n)})).next((function(){return u._n.performConsistencyCheck(t)})).next((function(){return u.Mn.pn(t,e)}))})))];case 2:return o=i.sent(),ml(r,e,n),gl(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,_l(r,o)];case 3:return i.sent(),[3,6];case 4:return[4,Ju(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}var s,a,u}))}))}function vl(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a;return i(this,(function(i){switch(i.label){case 0:Sh((n=Ii(t)).remoteStore)||vi("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(u=n.localStore,c=Ii(u),c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return c._n.getHighestUnacknowledgedBatchId(t)})))];case 2:return-1===(r=i.sent())?[2,void e.resolve()]:((o=n.Fo.get(r)||[]).push(e),n.Fo.set(r,o),[3,4]);case 3:return s=i.sent(),a=Kh(s,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}var u,c}))}))}function gl(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function ml(t,e,n){var r=Ii(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function bl(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||wl(t,e)}))}function wl(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(wh(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Tl(t))}function El(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof el?(t.No.addReference(o.key,e),Il(t,o)):o instanceof nl?(vi("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||wl(t,o.key)):wi()}}function Il(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(vi("SyncEngine","New document in limbo: "+n),t.So.add(r),Tl(t))}function Tl(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Yi(Li.fromString(e)),r=t.ko.next();t.Co.set(r,new ol(n)),t.Do=t.Do.insert(n,r),bh(t.remoteStore,new bu(Ko(Fo(n.path)),r,2,li.o))}}function _l(t,e,n){return r(this,void 0,void 0,(function(){var o,s,a,u;return i(this,(function(c){switch(c.label){case 0:return o=Ii(t),s=[],a=[],u=[],o.Po.isEmpty()?[3,3]:(o.Po.forEach((function(t,r){u.push(o.Oo(r,e,n).then((function(t){if(t){o.isPrimaryClient&&o.sharedClientState.updateQueryState(r.targetId,t.fromCache?"not-current":"current"),s.push(t);var e=wc.Pn(r.targetId,t);a.push(e)}})))})),[4,Promise.all(u)]);case 1:return c.sent(),o.vo._r(s),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a,u,c,h,l;return i(this,(function(i){switch(i.label){case 0:n=Ii(t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return ou.forEach(e,(function(e){return ou.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return ou.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return i.sent(),[3,4];case 3:if(!hu(r=i.sent()))throw r;return vi("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(o=0,s=e;o<s.length;o++)a=s[o],u=a.targetId,a.fromCache||(c=n.Fn.get(u),h=c.snapshotVersion,l=c.withLastLimboFreeSnapshotVersion(h),n.Fn=n.Fn.insert(u,l));return[2]}}))}))}(o.localStore,a)];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))}function Sl(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return(n=Ii(t)).currentUser.isEqual(e)?[3,3]:(vi("SyncEngine","User change. New user:",e.toKey()),[4,_c(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,(o=n).Fo.forEach((function(t){t.forEach((function(t){t.reject(new pi(fi.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),o.Fo.clear(),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,_l(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}var o}))}))}function Al(t,e){var n=Ii(t),r=n.Co.get(e);if(r&&r.bo)return zs().add(r.key);var i=zs(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function Nl(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,Rc((n=Ii(t)).localStore,e.query,!0)];case 1:return r=i.sent(),o=e.view.Ao(r),[2,(n.isPrimaryClient&&El(n,e.targetId,o.To),o)]}}))}))}function Dl(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){return[2,Oc((e=Ii(t)).localStore).then((function(t){return _l(e,t)}))]}))}))}function Cl(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s;return i(this,(function(i){switch(i.label){case 0:return[4,(a=(r=Ii(t)).localStore,u=e,c=Ii(a),h=Ii(c._n),c.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return h.jt(t,u).next((function(e){return e?c.Mn.pn(t,e):ou.resolve(null)}))})))];case 1:return null===(s=i.sent())?[3,6]:"pending"!==n?[3,3]:[4,xh(r.remoteStore)];case 2:return i.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(ml(r,e,o||null),gl(r,e),function(t,e){Ii(Ii(t)._n).Gt(e)}(r.localStore,e)):wi(),i.label=4;case 4:return[4,_l(r,s)];case 5:return i.sent(),[3,7];case 6:vi("SyncEngine","Cannot apply mutation batch with id: "+e),i.label=7;case 7:return[2]}var a,u,c,h}))}))}function kl(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a,u,c,h;return i(this,(function(i){switch(i.label){case 0:return Fl(n=Ii(t)),Ml(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Rl(n,r.toArray())]);case 1:return o=i.sent(),n.$o=!0,[4,Uh(n.remoteStore,!0)];case 2:for(i.sent(),s=0,a=o;s<a.length;s++)u=a[s],bh(n.remoteStore,u);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(c=[],h=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?c.push(e):h=h.then((function(){return bl(n,e),kc(n.localStore,e,!0)})),wh(n.remoteStore,e)})),[4,h]);case 4:return i.sent(),[4,Rl(n,c)];case 5:return i.sent(),(l=Ii(n)).Co.forEach((function(t,e){wh(l.remoteStore,e)})),l.No.ts(),l.Co=new Map,l.Do=new Ls(Yi.comparator),n.$o=!1,[4,Uh(n.remoteStore,!1)];case 6:i.sent(),i.label=7;case 7:return[2]}var l}))}))}function Rl(t,e,n){return r(this,void 0,void 0,(function(){var n,r,o,s,a,u,c,h,l,f,p,d,y,v;return i(this,(function(i){switch(i.label){case 0:n=Ii(t),r=[],o=[],s=0,a=e,i.label=1;case 1:return s<a.length?(u=a[s],c=void 0,(h=n.Vo.get(u))&&0!==h.length?[4,Cc(n.localStore,Ko(h[0]))]:[3,7]):[3,13];case 2:c=i.sent(),l=0,f=h,i.label=3;case 3:return l<f.length?(p=f[l],d=n.Po.get(p),[4,Nl(n,d)]):[3,6];case 4:(y=i.sent()).snapshot&&o.push(y.snapshot),i.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,xc(n.localStore,u)];case 8:return v=i.sent(),[4,Cc(n.localStore,v)];case 9:return c=i.sent(),[4,ul(n,xl(v),u,!1)];case 10:i.sent(),i.label=11;case 11:r.push(c),i.label=12;case 12:return s++,[3,1];case 13:return[2,(n.vo._r(o),r)]}}))}))}function xl(t){return Po(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Ol(t){var e=Ii(t);return Ii(Ii(e.localStore).persistence).fn()}function Ll(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s,a;return i(this,(function(i){switch(i.label){case 0:return(r=Ii(t)).$o?(vi("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!r.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Oc(r.localStore)];case 3:return s=i.sent(),a=Ws.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,_l(r,s,a)];case 4:return i.sent(),[3,8];case 5:return[4,kc(r.localStore,e,!0)];case 6:return i.sent(),bl(r,e,o),[3,8];case 7:wi(),i.label=8;case 8:return[2]}}))}))}function Pl(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,a,u,c,h,l,f,p;return i(this,(function(d){switch(d.label){case 0:if(!(r=Fl(t)).$o)return[3,10];o=0,s=e,d.label=1;case 1:return o<s.length?(a=s[o],r.Vo.has(a)?(vi("SyncEngine","Adding an already active target "+a),[3,5]):[4,xc(r.localStore,a)]):[3,6];case 2:return u=d.sent(),[4,Cc(r.localStore,u)];case 3:return c=d.sent(),[4,ul(r,xl(u),c.targetId,!1)];case 4:d.sent(),bh(r.remoteStore,c),d.label=5;case 5:return o++,[3,1];case 6:h=function(t){return i(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,kc(r.localStore,t,!1).then((function(){wh(r.remoteStore,t),bl(r,t)})).catch(Ju)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,f=n,d.label=7;case 7:return l<f.length?(p=f[l],[5,h(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function Fl(t){var e=Ii(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ll.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Al.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pl.bind(null,e),e.vo._r=$h.bind(null,e.eventManager),e.vo.Mo=Jh.bind(null,e.eventManager),e}function Ml(t){var e=Ii(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=dl.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=yl.bind(null,e),e}var Vl=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.R=ch(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Qo(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Qo=function(t){return Tc(this.persistence,new Ec,t.initialUser,this.R)},t.prototype.qo=function(t){return new jc(Gc.bs,this.R)},t.prototype.Bo=function(t){return new eh},t.prototype.terminate=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),Ul=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).Ko=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return e(n,t),n.prototype.initialize=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Lc(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,e)];case 3:return n.sent(),[4,Ml(this.Ko.syncEngine)];case 4:return n.sent(),[4,xh(this.Ko.remoteStore)];case 5:return n.sent(),[2]}}))}))},n.prototype.Qo=function(t){return Tc(this.persistence,new Ec,t.initialUser,this.R)},n.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new ec(e,t.asyncQueue)},n.prototype.qo=function(t){var e=mc(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Uu.withCacheSize(this.cacheSizeBytes):Uu.DEFAULT;return new yc(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,ah(),uh(),this.R,this.sharedClientState,!!this.forceOwnership)},n.prototype.Bo=function(t){return new eh},n}(Vl),ql=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ko=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return e(n,t),n.prototype.initialize=function(e){return r(this,void 0,void 0,(function(){var n,o=this;return i(this,(function(s){switch(s.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return s.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof th?(this.sharedClientState.syncEngine={ui:Cl.bind(null,n),ai:Ll.bind(null,n),hi:Pl.bind(null,n),fn:Ol.bind(null,n),ci:Dl.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:s.sent(),s.label=3;case 3:return[4,this.persistence.He((function(t){return r(o,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,kl(this.Ko.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return s.sent(),[2]}}))}))},n.prototype.Bo=function(t){var e=ah();if(!th.yt(e))throw new pi(fi.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=mc(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new th(e,t.asyncQueue,n,t.clientId,t.initialUser)},n}(Ul),Bl=function(){function t(){}return t.prototype.initialize=function(t,e){return r(this,void 0,void 0,(function(){var n=this;return i(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return fl(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Sl.bind(null,this.syncEngine),[4,Uh(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Wh},t.prototype.createDatastore=function(t){var e,n,r=ch(t.databaseInfo.databaseId),i=(e=t.databaseInfo,new sh(e));return n=t.credentials,new dh(n,i,r)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return fl(s.syncEngine,t,0)},o=rh.yt()?new rh:new nh,new vh(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return n=this.localStore,r=this.remoteStore,i=this.eventManager,o=this.sharedClientState,s=t.initialUser,a=t.maxConcurrentLimboResolutions,u=e,c=new sl(n,r,i,o,s,a),u&&(c.$o=!0),c;var n,r,i,o,s,a,u,c},t.prototype.terminate=function(){return function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=Ii(t),vi("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,mh(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),jl=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),Kl=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return r(this,void 0,void 0,(function(){var e,n=this;return i(this,(function(o){switch(o.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new pi(fi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,a,u;return i(this,(function(i){switch(i.label){case 0:return n=Ii(t),r=va(n.R)+"/documents",o={documents:e.map((function(t){return fa(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,o)];case 1:return s=i.sent(),a=new Map,s.forEach((function(t){var e,r,i=(e=n.R,"found"in(r=t)?function(t,e){Ei(!!e.found),e.found.name,e.found.updateTime;var n=pa(t,e.found.name),r=ca(e.found.updateTime),i=new ho({mapValue:{fields:e.found.fields}});return fo.newFoundDocument(n,r,i)}(e,r):"missing"in r?function(t,e){Ei(!!e.missing),Ei(!!e.readTime);var n=pa(t,e.missing),r=ca(e.readTime);return fo.newNoDocument(n,r)}(e,r):wi());a.set(i.key.toString(),i)})),u=[],[2,(e.forEach((function(t){var e=a.get(t.toString());Ei(!!e),u.push(e)})),u)]}}))}))}(this.datastore,t)];case 1:return[2,((e=o.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new Cs(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return r(this,void 0,void 0,(function(){var t,e=this;return i(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Yi.fromPath(n);e.mutations.push(new ks(r,e.precondition(r)))})),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=Ii(t),r=va(n.R)+"/documents",o={writes:e.map((function(t){return ba(n.R,t)}))},[4,n.Ni("Commit",r,o)];case 1:return i.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw wi();e=Ci.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new pi(fi.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?ds.updateTime(e):ds.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Ci.min()))throw new pi(fi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ds.updateTime(e)}return ds.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),Gl=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new hh(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return r(t,void 0,void 0,(function(){var t,e,n=this;return i(this,(function(r){return t=new Kl(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Hi(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!xs(e)}return!1},t}(),zl=function(){function t(t,e,n){var o=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=zc.UNAUTHENTICATED,this.clientId=_i.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return r(o,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return vi("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new pi(fi.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new iu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return r(t,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Kh(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Hl(t,e){return r(this,void 0,void 0,(function(){var n,o,s=this;return i(this,(function(a){switch(a.label){case 0:return t.asyncQueue.verifyOperationInProgress(),vi("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=a.sent(),[4,e.initialize(n)];case 2:return a.sent(),o=n.initialUser,t.setCredentialChangeListener((function(t){return r(s,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return o.isEqual(t)?[3,2]:[4,_c(e.localStore,t)];case 1:n.sent(),o=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Ql(t,e){return r(this,void 0,void 0,(function(){var n,o;return i(this,(function(s){switch(s.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Wl(t)];case 1:return n=s.sent(),vi("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return o=s.sent(),[4,e.initialize(n,o)];case 3:return s.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return(n=Ii(t)).asyncQueue.verifyOperationInProgress(),vi("RemoteStore","RemoteStore received new credentials"),r=Sh(n),n.Or.add(3),[4,mh(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,gh(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Wl(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(vi("FirestoreClient","Using default OfflineComponentProvider"),[4,Hl(t,new Vl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Yl(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(vi("FirestoreClient","Using default OnlineComponentProvider"),[4,Ql(t,new Bl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Xl(t){return Wl(t).then((function(t){return t.persistence}))}function $l(t){return Wl(t).then((function(t){return t.localStore}))}function Jl(t){return Yl(t).then((function(t){return t.remoteStore}))}function Zl(t){return Yl(t).then((function(t){return t.syncEngine}))}function tf(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return[4,Yl(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=al.bind(null,e.syncEngine),n.onUnlisten=cl.bind(null,e.syncEngine),n)]}}))}))}function ef(t,e,n){var o=this;void 0===n&&(n={});var s=new iu;return t.asyncQueue.enqueueAndForget((function(){return r(o,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new jl({next:function(o){e.enqueueAndForget((function(){return Xh(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new pi(fi.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new pi(fi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new tl(Fo(n.path),o,{includeMetadataChanges:!0,so:!0});return Yh(t,s)},[4,tf(t)];case 1:return[2,r.apply(void 0,[i.sent(),t.asyncQueue,e,n,s])]}}))}))})),s.promise}function nf(t,e,n){var o=this;void 0===n&&(n={});var s=new iu;return t.asyncQueue.enqueueAndForget((function(){return r(o,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new jl({next:function(n){e.enqueueAndForget((function(){return Xh(t,s)})),n.fromCache&&"server"===r.source?i.reject(new pi(fi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new tl(n,o,{includeMetadataChanges:!0,so:!0});return Yh(t,s)},[4,tf(t)];case 1:return[2,r.apply(void 0,[i.sent(),t.asyncQueue,e,n,s])]}}))}))})),s.promise}var rf=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},of=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),sf=new Map,af=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},uf=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(zc.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),cf=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),hf=function(){function t(t){var e=this;this.currentUser=zc.UNAUTHENTICATED,this.oc=new iu,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){vi("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(vi("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(vi("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Ei("string"==typeof n.accessToken),new af(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return r(n,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Ei(null===t||"string"==typeof t),new zc(t)},t}(),lf=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=zc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),ff=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new lf(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(zc.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pf(t,e,n){if(!n)throw new pi(fi.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function df(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new pi(fi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function yf(t,e,n,r){if(!0===e&&!0===r)throw new pi(fi.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function vf(t){if(!Yi.isDocumentKey(t))throw new pi(fi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function gf(t){if(Yi.isDocumentKey(t))throw new pi(fi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function mf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":wi()}function bf(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new pi(fi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=mf(t);throw new pi(fi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function wf(t,e){if(e<=0)throw new pi(fi.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ef=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new pi(fi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new pi(fi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,yf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),If=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ef({}),this._settingsFrozen=!1,t instanceof of?(this._databaseId=t,this._credentials=new uf):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new pi(fi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new of(t.options.projectId)}(t),this._credentials=new hf(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new pi(fi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new pi(fi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ef(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new uf;switch(t.type){case"gapi":var e=t.client;return Ei(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ff(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new pi(fi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=sf.get(this))&&(vi("ComponentProvider","Removing Datastore"),sf.delete(this),t.terminate()),Promise.resolve();var t},t}(),Tf=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Sf(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),_f=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Sf=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n,Fo(r))||this)._path=r,i.type="collection",i}return e(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Tf(this.firestore,null,new Yi(t))},enumerable:!1,configurable:!0}),n.prototype.withConverter=function(t){return new n(this.firestore,t,this._path)},n}(_f);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Af(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=E(t),pf("collection","path",e),t instanceof If)return gf(n=Li.fromString.apply(Li,a([e],r))),new Sf(t,null,n);if(!(t instanceof Tf||t instanceof Sf))throw new pi(fi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return gf(n=Li.fromString.apply(Li,a([t.path],r)).child(Li.fromString(e))),new Sf(t.firestore,null,n)}function Nf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=E(t),1===arguments.length&&(e=_i.u()),pf("doc","path",e),t instanceof If)return vf(n=Li.fromString.apply(Li,a([e],r))),new Tf(t,null,new Yi(n));if(!(t instanceof Tf||t instanceof Sf))throw new pi(fi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return vf(n=t._path.child(Li.fromString.apply(Li,a([e],r)))),new Tf(t.firestore,t instanceof Sf?t.converter:null,new Yi(n))}function Df(t,e){return t=E(t),e=E(e),(t instanceof Tf||t instanceof Sf)&&(e instanceof Tf||e instanceof Sf)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Cf(t,e){return t=E(t),e=E(e),t instanceof _f&&e instanceof _f&&t.firestore===e.firestore&&zo(t._query,e._query)&&t.converter===e.converter}var kf=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new hh(this,"async_queue_retry"),this.Tc=function(){var e=uh();e&&vi("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=uh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=uh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise((function(t){})):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.Rc()}))},t.prototype.Rc=function(){return r(this,void 0,void 0,(function(){var t,e=this;return i(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!hu(t=n.sent()))throw t;return vi("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.Rc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Ac=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,gi("INTERNAL UNHANDLED ERROR: ",(r=(n=t).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),t;var n,r})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=jh.createAndSchedule(this,t,e,n,(function(t){return r.bc(t)}));return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&wi()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()}))},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function Rf(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var xf=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new kf,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return e(n,t),n.prototype._terminate=function(){return this._firestoreClient||Lf(this),this._firestoreClient.terminate()},n}(If);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Of(t){return t._firestoreClient||Lf(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Lf(t){var e,n,r,i,o,s=t._freezeSettings(),a=(n=t._databaseId,r=(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",i=t._persistenceKey,new rf(n,r,i,(o=s).host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,o.useFetchStreams));t._firestoreClient=new zl(t._credentials,t._queue,a)}function Pf(t,e,n){var o=this,s=new iu;return t.asyncQueue.enqueue((function(){return r(o,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,Hl(t,n)];case 1:return i.sent(),[4,Ql(t,e)];case 2:return i.sent(),s.resolve(),[3,4];case 3:if(!("FirebaseError"===(o=r=i.sent()).name?o.code===fi.FAILED_PRECONDITION||o.code===fi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&o instanceof DOMException)||22===o.code||20===o.code||11===o.code))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),s.reject(r),[3,4];case 4:return[2]}var o}))}))})).then((function(){return s.promise}))}function Ff(t){if(t._initialized||t._terminated)throw new pi(fi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new pi(fi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Fi(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),Vf=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Vi.fromBase64String(e))}catch(n){throw new pi(fi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}},t.fromUint8Array=function(e){return new t(Vi.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),Uf=function(t){this._methodName=t},qf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new pi(fi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new pi(fi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Si(this._lat,t._lat)||Si(this._long,t._long)},t}(),Bf=/^__.*__$/,jf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Ts(t,this.data,this.fieldMask,e,this.fieldTransforms):new Is(t,this.data,e,this.fieldTransforms)},t}(),Kf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Ts(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wi()}}var zf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return lp(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(Gf(this.Cc)&&Bf.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),Hf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||ch(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new zf({Cc:t,methodName:e,Bc:n,path:Fi.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Qf(t){var e=t._freezeSettings(),n=ch(t._databaseId);return new Hf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Wf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qc(o.merge||o.mergeFields?2:0,e,n,i);ap("Data must be an object, but it was:",s,r);var a,u,c=op(r,s);if(o.merge)a=new Mi(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=up(e,f[l],n);if(!s.contains(p))throw new pi(fi.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");fp(h,p)||h.push(p)}a=new Mi(h),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new jf(new ho(c),a,u)}var Yf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw 1===t.Cc?t.Mc(this._methodName+"() can only appear at the top level of your update data"):t.Mc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},n.prototype.isEqual=function(t){return t instanceof n},n}(Uf);function Xf(t,e,n){return new zf({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var $f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype._toFieldTransform=function(t){return new fs(t.path,new is)},n.prototype.isEqual=function(t){return t instanceof n},n}(Uf),Jf=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return e(n,t),n.prototype._toFieldTransform=function(t){var e=Xf(this,t,!0),n=this.Uc.map((function(t){return ip(t,e)})),r=new os(n);return new fs(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(Uf),Zf=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return e(n,t),n.prototype._toFieldTransform=function(t){var e=Xf(this,t,!0),n=this.Uc.map((function(t){return ip(t,e)})),r=new as(n);return new fs(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(Uf),tp=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return e(n,t),n.prototype._toFieldTransform=function(t){var e=new cs(t.R,Zo(t.R,this.Qc));return new fs(t.path,e)},n.prototype.isEqual=function(t){return this===t},n}(Uf);function ep(t,e,n,r){var i=t.qc(1,e,n);ap("Data must be an object, but it was:",i,r);var o=[],s=ho.empty();Ri(r,(function(t,r){var a=hp(e,t,n);r=E(r);var u=i.$c(a);if(r instanceof Yf)o.push(a);else{var c=ip(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new Mi(o);return new Kf(s,a,i.fieldTransforms)}function np(t,e,n,r,i,o){var s=t.qc(1,e,n),a=[up(e,r,n)],u=[i];if(o.length%2!=0)throw new pi(fi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(up(e,o[c])),u.push(o[c+1]);for(var h=[],l=ho.empty(),f=a.length-1;f>=0;--f)if(!fp(h,a[f])){var p=a[f],d=u[f];d=E(d);var y=s.$c(p);if(d instanceof Yf)h.push(p);else{var v=ip(d,y);null!=v&&(h.push(p),l.set(p,v))}}var g=new Mi(h);return new Kf(l,g,s.fieldTransforms)}function rp(t,e,n,r){return void 0===r&&(r=!1),ip(n,t.qc(r?4:3,e))}function ip(t,e){if(sp(t=E(t)))return ap("Unsupported field value:",e,t),op(t,e);if(t instanceof Uf)return function(t,e){if(!Gf(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=ip(o[i],e.Oc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=E(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Zo(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Di.fromDate(t);return{timestampValue:sa(e.R,n)}}if(t instanceof Di)return n=new Di(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:sa(e.R,n)};if(t instanceof qf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Vf)return{bytesValue:aa(e.R,t._byteString)};if(t instanceof Tf){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ha(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+mf(t))}(t,e)}function op(t,e){var n={};return xi(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ri(t,(function(t,r){var i=ip(r,e.xc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function sp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Di||t instanceof qf||t instanceof Vf||t instanceof Tf||t instanceof Uf)}function ap(t,e,n){if(!sp(n)||("object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))){var r=mf(n);throw"an object"===r?e.Mc(t+" a custom object"):e.Mc(t+" "+r)}var i}function up(t,e,n){if((e=E(e))instanceof Mf)return e._internalPath;if("string"==typeof e)return hp(t,e);throw lp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var cp=new RegExp("[~\\*/\\[\\]]");function hp(t,e,n){if(e.search(cp)>=0)throw lp("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Mf.bind.apply(Mf,a([void 0],e.split(".")))))._internalPath}catch(r){throw lp("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function lp(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new pi(fi.INVALID_ARGUMENT,(a+=". ")+t+u)}function fp(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pp=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Tf(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new dp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(yp("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),dp=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.data=function(){return t.prototype.data.call(this)},n}(pp);function yp(t,e){return"string"==typeof e?hp(t,e):e instanceof Mf?e._internalPath:e._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),gp=function(t){function n(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return e(n,t),n.prototype.exists=function(){return t.prototype.exists.call(this)},n.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new mp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},n.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(yp("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},n}(pp),mp=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},n}(gp),bp=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new vp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new mp(n._firestore,n._userDataWriter,r.key,r,new vp(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new pi(fi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){var r=new mp(t._firestore,t._userDataWriter,e.doc.key,e.doc,new vp(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new mp(t._firestore,t._userDataWriter,e.doc.key,e.doc,new vp(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:wp(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function wp(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wi()}}function Ep(t,e){return t instanceof gp&&e instanceof gp?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof bp&&e instanceof bp&&t._firestore===e._firestore&&Cf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ip(t){if(Vo(t)&&0===t.explicitOrderBy.length)throw new pi(fi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Tp=function(){};function _p(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Sp=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).Kc=e,i.jc=n,i.Wc=r,i.type="where",i}return e(n,t),n.prototype._apply=function(t){var e,n,r,i=Qf(t.firestore),o=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new pi(fi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){xp(s,o);for(var u=[],c=0,h=s;c<h.length;c++){var l=h[c];u.push(Rp(r,t,l))}a={arrayValue:{values:u}}}else a=Rp(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||xp(s,o),a=rp(n,"where",s,"in"===o||"not-in"===o);var f=bo.create(i,o,a);return function(t,e){if(e.g()){var n=qo(t);if(null!==n&&!n.isEqual(e.field))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Uo(t);null!==r&&Op(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new pi(fi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new pi(fi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,i,t.firestore._databaseId,this.Kc,this.jc,this.Wc);return new _f(t.firestore,t.converter,(e=t._query,n=o,r=e.filters.concat([n]),new Lo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)))},n}(Tp),Ap=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).Kc=e,r.Gc=n,r.type="orderBy",r}return e(n,t),n.prototype._apply=function(t){var e,n,r,i=function(t,e,n){if(null!==t.startAt)throw new pi(fi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new pi(fi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ko(e,n);return function(t,e){if(null===Uo(t)){var n=qo(t);null!==n&&Op(t,n,e.field)}}(t,r),r}(t._query,this.Kc,this.Gc);return new _f(t.firestore,t.converter,(e=t._query,n=i,r=e.explicitOrderBy.concat([n]),new Lo(e.path,e.collectionGroup,r,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)))},n}(Tp),Np=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return e(n,t),n.prototype._apply=function(t){return new _f(t.firestore,t.converter,Go(t._query,this.zc,this.Hc))},n}(Tp),Dp=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return e(n,t),n.prototype._apply=function(t){var e,n,r=kp(t,this.type,this.Jc,this.Yc);return new _f(t.firestore,t.converter,(e=t._query,n=r,new Lo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,n,e.endAt)))},n}(Tp),Cp=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return e(n,t),n.prototype._apply=function(t){var e,n,r=kp(t,this.type,this.Jc,this.Yc);return new _f(t.firestore,t.converter,(e=t._query,n=r,new Lo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,n)))},n}(Tp);function kp(t,e,n,r){if(n[0]=E(n[0]),n[0]instanceof pp)return function(t,e,n,r,i){if(!r)throw new pi(fi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=jo(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(ro(e,r.key));else{var c=r.data.field(u.field);if(Ki(c))throw new pi(fi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new pi(fi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Do(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Qf(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new pi(fi.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new pi(fi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Bo(t)&&-1!==c.indexOf("/"))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Li.fromString(c));if(!Yi.isDocumentKey(h))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Yi(h);a.push(ro(e,l))}else{var f=rp(n,r,c);a.push(f)}}return new Do(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function Rp(t,e,n){if("string"==typeof(n=E(n))){if(""===n)throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Bo(e)&&-1!==n.indexOf("/"))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Li.fromString(n));if(!Yi.isDocumentKey(r))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ro(t,new Yi(r))}if(n instanceof Tf)return ro(t,n._key);throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+mf(n)+".")}function xp(t,e){if(!Array.isArray(t)||0===t.length)throw new pi(fi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new pi(fi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Op(t,e,n){if(!n.isEqual(e))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lp=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Xi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Bi(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(ji(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw wi()}},t.prototype.convertObject=function(t,e){var n=this,r={};return Ri(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new qf(Bi(t.latitude),Bi(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Gi(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(zi(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=qi(t);return new Di(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=Li.fromString(t);Ei(La(n));var r=new of(n.get(1),n.get(3)),i=new Yi(n.popFirst(5));return r.isEqual(e)||gi("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Fp=function(t){function n(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return e(n,t),n.prototype.convertBytes=function(t){return new Vf(t)},n.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Tf(this.firestore,null,e)},n}(Lp),Mp=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Qf(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Vp(t,this._firestore),i=Pp(r.converter,e,n),o=Wf(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,ds.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=Vp(t,this._firestore);return o="string"==typeof(e=E(e))||e instanceof Mf?np(this._dataReader,"WriteBatch.update",s._key,e,n,r):ep(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,ds.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Vp(t,this._firestore);return this._mutations=this._mutations.concat(new Cs(e._key,ds.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new pi(fi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(t,e){if((t=E(t)).firestore!==e)throw new pi(fi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Up=function(t){function n(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return e(n,t),n.prototype.convertBytes=function(t){return new Vf(t)},n.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Tf(this.firestore,null,e)},n}(Lp);function qp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=bf(t,Tf);var o=bf(t.firestore,xf),s=Qf(o);return jp(o,[("string"==typeof(e=E(e))||e instanceof Mf?np(s,"updateDoc",t._key,e,n,r):ep(s,"updateDoc",t._key,e)).toMutation(t._key,ds.exists(!0))])}function Bp(t){for(var e,n,o,s=[],a=1;a<arguments.length;a++)s[a-1]=arguments[a];t=E(t);var u={includeMetadataChanges:!1},c=0;"object"!=typeof s[c]||Rf(s[c])||(u=s[c],c++);var h,l,f,p={includeMetadataChanges:u.includeMetadataChanges};if(Rf(s[c])){var d=s[c];s[c]=null===(e=d.next)||void 0===e?void 0:e.bind(d),s[c+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),s[c+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(t instanceof Tf)l=bf(t.firestore,xf),f=Fo(t._key.path),h={next:function(e){s[c]&&s[c](Kp(l,t,e))},error:s[c+1],complete:s[c+2]};else{var y=bf(t,_f);l=bf(y.firestore,xf),f=y._query;var v=new Up(l);h={next:function(t){s[c]&&s[c](new bp(l,v,y,t))},error:s[c+1],complete:s[c+2]},Ip(t._query)}return function(t,e,n,o){var s=this,a=new jl(o),u=new tl(e,a,n);return t.asyncQueue.enqueueAndForget((function(){return r(s,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=Yh,[4,tf(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))})),function(){a.Wo(),t.asyncQueue.enqueueAndForget((function(){return r(s,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=Xh,[4,tf(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))}))}}(Of(l),f,p,h)}function jp(t,e){return function(t,e){var n=this,o=new iu;return t.asyncQueue.enqueueAndForget((function(){return r(n,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return n=hl,[4,Zl(t)];case 1:return[2,n.apply(void 0,[r.sent(),e,o])]}}))}))})),o.promise}(Of(t),e)}function Kp(t,e,n){var r=n.docs.get(e._key),i=new Up(t);return new gp(t,i,e._key,r,new vp(n.hasPendingWrites,n.fromCache),e.converter)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gp=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return e(n,t),n.prototype.get=function(e){var n=this,r=Vp(e,this._firestore),i=new Up(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new gp(n._firestore,i,r._key,t._document,new vp(!1,!1),r.converter)}))},n}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Qf(t)}return t.prototype.get=function(t){var e=this,n=Vp(t,this._firestore),r=new Fp(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return wi();var i=t[0];if(i.isFoundDocument())return new pp(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new pp(e._firestore,r,n._key,null,n.converter);throw wi()}))},t.prototype.set=function(t,e,n){var r=Vp(t,this._firestore),i=Pp(r.converter,e,n),o=Wf(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Vp(t,this._firestore);return o="string"==typeof(e=E(e))||e instanceof Mf?np(this._dataReader,"Transaction.update",s._key,e,n,r):ep(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=Vp(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(){if("undefined"==typeof Uint8Array)throw new pi(fi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Hp(){if("undefined"==typeof atob)throw new pi(fi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Qp=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Hp(),new t(Vf.fromBase64String(e))},t.fromUint8Array=function(e){return zp(),new t(Vf.fromUint8Array(e))},t.prototype.toBase64=function(){return Hp(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return zp(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Wp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Ff(t=bf(t,xf));var n=Of(t),r=t._freezeSettings(),i=new Bl;return Pf(n,i,new Ul(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Ff(t=bf(t,xf));var e=Of(t),n=t._freezeSettings(),r=new Bl;return Pf(e,r,new ql(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new pi(fi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new iu;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return r(e,void 0,void 0,(function(){var e;return i(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return au.yt()?(e=t+"main",[4,au.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(mc(t._databaseId,t._persistenceKey))];case 1:return o.sent(),n.resolve(),[3,3];case 2:return e=o.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Yp=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof of||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||mi("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,r){void 0===r&&(r={}),function(t,e,r,i){void 0===i&&(i={});var o=(t=bf(t,If))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&mi("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:e+":"+r,ssl:!1})),i.mockUserToken){var s=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var r=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var s=n({iss:"https://securetoken.google.com/"+r,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[u.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),u.encodeString(JSON.stringify(s),!1),""].join(".")}(i.mockUserToken),a=i.mockUserToken.sub||i.mockUserToken.user_id;if(!a)throw new pi(fi.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new cf(new af(s,new zc(a)))}}(this._delegate,t,e,r)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return r(e,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return[4,Xl(t)];case 1:return e=r.sent(),[4,Jl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),i=n,o=Ii(i),o.Or.delete(0),gh(o))]}var i,o}))}))}))}(Of(bf(this._delegate,xf)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return r(e,void 0,void 0,(function(){var e,n;return i(this,(function(o){switch(o.label){case 0:return[4,Xl(t)];case 1:return e=o.sent(),[4,Jl(t)];case 2:return n=o.sent(),[2,(e.setNetworkEnabled(!1),function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return(e=Ii(t)).Or.add(0),[4,mh(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Of(bf(this._delegate,xf)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&yf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new iu;return t.asyncQueue.enqueueAndForget((function(){return r(e,void 0,void 0,(function(){var e;return i(this,(function(r){switch(r.label){case 0:return e=vl,[4,Zl(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Of(bf(this._delegate,xf)))},t.prototype.onSnapshotsInSync=function(t){return e=this._delegate,n=t,function(t,e){var n=this,o=new jl(e);return t.asyncQueue.enqueueAndForget((function(){return r(n,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=function(t,e){Ii(t).Gr.add(e),e.next()},[4,tf(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return r(n,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=function(t,e){Ii(t).Gr.delete(e)},[4,tf(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}}))}))}))}}(Of(e=bf(e,xf)),Rf(n)?n:{next:n});var e,n},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new pi(fi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new cd(this,Af(this._delegate,t))}catch(e){throw ed(e,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new td(this,Nf(this._delegate,t))}catch(e){throw ed(e,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new sd(this,function(t,e){if(t=bf(t,If),pf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new pi(fi.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new _f(t,null,(n=e,new Lo(Li.emptyPath(),n)));var n}(this._delegate,t))}catch(e){throw ed(e,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e,n=this;return function(t,e){var n=this,o=new iu;return t.asyncQueue.enqueueAndForget((function(){return r(n,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,(i=t,Yl(i).then((function(t){return t.datastore})))];case 1:return n=r.sent(),new Gl(t.asyncQueue,n,e,o).run(),[2]}var i}))}))})),o.promise}(Of(e=this._delegate),(function(r){return function(e){return t(new $p(n,e))}(new Gp(e,r))}))},t.prototype.batch=function(){var t=this;return Of(this._delegate),new Jp(new Mp(this._delegate,(function(e){return jp(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new pi(fi.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new pi(fi.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Xp=function(t){function n(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return e(n,t),n.prototype.convertBytes=function(t){return new Qp(new Vf(t))},n.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return td.tu(e,this.firestore,null)},n}(Lp);var $p=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Xp(t)}return t.prototype.get=function(t){var e=this,n=hd(t);return this._delegate.get(n).then((function(t){return new id(e._firestore,new gp(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=hd(t);return n?(df("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=hd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,a([s,e,n],i)),this},t.prototype.delete=function(t){var e=hd(t);return this._delegate.delete(e),this},t}(),Jp=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=hd(t);return n?(df("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=hd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,a([s,e,n],i)),this},t.prototype.delete=function(t){var e=hd(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Zp=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new mp(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new od(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Xp(e),n),i.set(n,o)),o},t}();Zp.nu=new WeakMap;var td=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Xp(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new pi(fi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Tf(n._delegate,r,new Yi(e)))},t.tu=function(e,n,r){return new t(n,new Tf(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new cd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new cd(this.firestore,Af(this._delegate,t))}catch(e){throw ed(e,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=E(t))instanceof Tf&&Df(this._delegate,t)},t.prototype.set=function(t,e){e=df("DocumentReference.set",e);try{return function(t,e,n){t=bf(t,Tf);var r=bf(t.firestore,xf),i=Pp(t.converter,e,n);return jp(r,[Wf(Qf(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,ds.none())])}(this._delegate,t,e)}catch(n){throw ed(n,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?qp(this._delegate,t):qp.apply(void 0,a([this._delegate,t,e],n))}catch(i){throw ed(i,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return jp(bf((t=this._delegate).firestore,xf),[new Cs(t._key,ds.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=nd(e),i=rd(e,(function(e){return new id(t.firestore,new gp(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return Bp(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=bf(t,Tf);var e=bf(t.firestore,xf),n=Of(e),o=new Up(e);return function(t,e){var n=this,o=new iu;return t.asyncQueue.enqueueAndForget((function(){return r(n,void 0,void 0,(function(){var n;return i(this,(function(s){switch(s.label){case 0:return n=function(t,e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,(s=t,a=e,u=Ii(s),u.persistence.runTransaction("read document","readonly",(function(t){return u.Mn.mn(t,a)})))];case 1:return(o=i.sent()).isFoundDocument()?n.resolve(o):o.isNoDocument()?n.resolve(null):n.reject(new pi(fi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=i.sent(),o=Kh(r,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}var s,a,u}))}))},[4,$l(t)];case 1:return[2,n.apply(void 0,[s.sent(),e,o])]}}))}))})),o.promise}(n,t._key).then((function(n){return new gp(e,o,t._key,n,new vp(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=bf(t,Tf);var e=bf(t.firestore,xf);return ef(Of(e),t._key,{source:"server"}).then((function(n){return Kp(e,t,n)}))}(this._delegate):function(t){t=bf(t,Tf);var e=bf(t.firestore,xf);return ef(Of(e),t._key).then((function(n){return Kp(e,t,n)}))}(this._delegate)).then((function(t){return new id(e.firestore,new gp(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Zp.eu(this.firestore,e)):this._delegate.withConverter(null))},t}();function ed(t,e,n){return t.message=t.message.replace(e,n),t}function nd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Rf(r))return r}return{}}function rd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Rf(t[0])?t[0]:Rf(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var id=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new td(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Ep(this._delegate,t._delegate)},t}(),od=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.data=function(t){return this._delegate.data(t)},n}(id),sd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Xp(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,_p(this._delegate,(o=r,s=i=n,a=yp("where",e),new Sp(a,s,o))))}catch(i){throw ed(i,/(orderBy|where)\(\)/,"Query.$1()")}var i,o,s,a},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,_p(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=yp("orderBy",t);return new Ap(r,n)}(e,n)))}catch(r){throw ed(r,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,_p(this._delegate,(wf("limit",n=e),new Np("limit",n,"F"))))}catch(r){throw ed(r,"limit()","Query.limit()")}var n},t.prototype.limitToLast=function(e){try{return new t(this.firestore,_p(this._delegate,(wf("limitToLast",n=e),new Np("limitToLast",n,"L"))))}catch(r){throw ed(r,"limitToLast()","Query.limitToLast()")}var n},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,_p(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Dp("startAt",t,!0)}.apply(void 0,e)))}catch(r){throw ed(r,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,_p(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Dp("startAfter",t,!1)}.apply(void 0,e)))}catch(r){throw ed(r,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,_p(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Cp("endBefore",t,!0)}.apply(void 0,e)))}catch(r){throw ed(r,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,_p(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Cp("endAt",t,!1)}.apply(void 0,e)))}catch(r){throw ed(r,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return Cf(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=bf(t,_f);var e=bf(t.firestore,xf),n=Of(e),o=new Up(e);return function(t,e){var n=this,o=new iu;return t.asyncQueue.enqueueAndForget((function(){return r(n,void 0,void 0,(function(){var n;return i(this,(function(s){switch(s.label){case 0:return n=function(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,a,u;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Rc(t,e,!0)];case 1:return u=i.sent(),r=new rl(e,u.Bn),o=r._o(u.documents),s=r.applyChanges(o,!1),n.resolve(s.snapshot),[3,3];case 2:return a=i.sent(),u=Kh(a,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}}))}))},[4,$l(t)];case 1:return[2,n.apply(void 0,[s.sent(),e,o])]}}))}))})),o.promise}(n,t._query).then((function(n){return new bp(e,o,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=bf(t,_f);var e=bf(t.firestore,xf),n=Of(e),r=new Up(e);return nf(n,t._query,{source:"server"}).then((function(n){return new bp(e,r,t,n)}))}(this._delegate):function(t){t=bf(t,_f);var e=bf(t.firestore,xf),n=Of(e),r=new Up(e);return Ip(t._query),nf(n,t._query).then((function(n){return new bp(e,r,t,n)}))}(this._delegate)).then((function(t){return new ud(e.firestore,new bp(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=nd(e),i=rd(e,(function(e){return new ud(t.firestore,new bp(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return Bp(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Zp.eu(this.firestore,e)):this._delegate.withConverter(null))},t}(),ad=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new od(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),ud=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new sd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new od(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new ad(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new od(n._firestore,r))}))},t.prototype.isEqual=function(t){return Ep(this._delegate,t._delegate)},t}(),cd=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return e(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new td(this.firestore,t):null},enumerable:!1,configurable:!0}),n.prototype.doc=function(t){try{return new td(this.firestore,void 0===t?Nf(this._delegate):Nf(this._delegate,t))}catch(e){throw ed(e,"doc()","CollectionReference.doc()")}},n.prototype.add=function(t){var e,n,r,i,o,s=this;return(e=this._delegate,n=t,r=bf(e.firestore,xf),i=Nf(e),o=Pp(e.converter,n),jp(r,[Wf(Qf(e.firestore),"addDoc",i._key,o,null!==e.converter,{}).toMutation(i._key,ds.exists(!1))]).then((function(){return i}))).then((function(t){return new td(s.firestore,t)}))},n.prototype.isEqual=function(t){return Df(this._delegate,t._delegate)},n.prototype.withConverter=function(t){return new n(this.firestore,t?this._delegate.withConverter(Zp.eu(this.firestore,t)):this._delegate.withConverter(null))},n}(sd);function hd(t){return bf(t,Tf)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ld,fd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(Mf.bind.apply(Mf,a([void 0],t)))}return t.documentId=function(){return new t(Fi.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=E(t))instanceof Mf&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),pd=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new $f("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Yf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jf("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Zf("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=new tp("increment",e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),dd={Firestore:Yp,GeoPoint:qf,Timestamp:Di,Blob:Qp,Transaction:$p,WriteBatch:Jp,DocumentReference:td,DocumentSnapshot:id,Query:sd,QueryDocumentSnapshot:od,QuerySnapshot:ud,CollectionReference:cd,FieldPath:fd,FieldValue:pd,setLogLevel:function(t){var e;e=t,di.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(ld=X).INTERNAL.registerComponent(new I("firestore",(function(t){return function(t,e){return new Yp(t,new xf(t,e),new Wp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},dd))),ld.registerVersion("@firebase/firestore","2.3.6");export{X as f};
